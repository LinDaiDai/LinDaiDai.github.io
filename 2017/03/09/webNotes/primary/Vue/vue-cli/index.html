<!DOCTYPE html>
<html lang="en">




<head><meta name="generator" content="Hexo 3.8.0">

  <!-- Basic Page Needs
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta charset="utf-8">
  
      <title>vue-cli - LinDaiDai</title>
  

  
  
  <meta name="description" content="">
  <meta name="author" content="LinDaiDai">

  <!-- Mobile Specific Metas
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- load loadjs.js -->
  <script src="/libs/loadjs/dist/loadjs.min.js"></script>

<link rel="stylesheet" href="/libs/animate.css/animate.min.css">
  <!-- load lightgallery -->
<link rel="stylesheet" href="/css/lightgallery.css">
<link rel="stylesheet" href="/libs/noty/lib/noty.css">
<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
  






    <link rel="stylesheet" href="/css/taurus.css">
    
        <link rel="stylesheet" href="/css/scheme-taurus/animations.css">
    


<link rel="stylesheet" href="/.css">

  <!-- load font awesome 5 -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ" crossorigin="anonymous">

  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
  });
  </script>
  <!-- load mathjax -->
  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax//libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <!-- load js-cookie -->
  <script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script>
    <script src="/js/social-share.min.js"></script>
    <script src="/js/theme.js"></script>

  <!-- include cookie.js -->
  
  

  <!-- include comment system code -->
  
    <script src="//cdn1.lncld.net/static/js/3.6.4/av-min.js"></script>
<script src="//unpkg.com/valine/dist/Valine.min.js"></script>
  
  <!-- Favicon
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link rel="icon" type="image/png" href="/images/wang.png">
</head>
<body style="display: flex; flex-direction: column; min-height: 100vh;">

 

<header id="header" class="header">
	<div class="header-title">
		
		<div class="header-logo">
			<a href="/">
				<img src="/images/lindaidai-logo.jpg">
			</a>
		</div>
		<div class="header-text">
			<h1>
				<a href="/">LinDaiDai</a>
			</h1>
			<subtitle>
				王霈霖的个人博客
			</subtitle>
		</div>
		
	</div>
	<div id="header-nav">
		



<nav id="nav">
	
	
		
			
		
		
			<div class="nav-item">
				
					<div class="nav-name">
				
					<a class="nav-link" href="/home/">
						<span>首页 </span>
					</a>
				</div>
			</div>
		
	
		
			
		
		
			<div class="nav-item">
				
					<div class="nav-name">
				
					<a class="nav-link" href="/about/">
						<span>关于 </span>
					</a>
				</div>
			</div>
		
	
	
	<div class="nav-item" id="nav-item-toc">
		


<div class="toc-container">
<i class="far fa-times-circle" id="toc-close" onclick="closeTOC(event);" ontouchstart="closeTOC(event);"></i>
<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#第一章-项目运行"><span class="toc-number">1.</span> <span class="toc-text">第一章: 项目运行</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第二章-router"><span class="toc-number">2.</span> <span class="toc-text">第二章: router</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-基本使用"><span class="toc-number">2.1.</span> <span class="toc-text">2.1 基本使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-案例1"><span class="toc-number">2.2.</span> <span class="toc-text">2.2 案例1:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-通过js控制跳转"><span class="toc-number">2.3.</span> <span class="toc-text">2.3 通过js控制跳转</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-路由器嵌套"><span class="toc-number">2.4.</span> <span class="toc-text">2.4 路由器嵌套</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-案例"><span class="toc-number">2.4.1.</span> <span class="toc-text">1. 案例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-重定向"><span class="toc-number">2.5.</span> <span class="toc-text">2.5 重定向</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-6-路由配合动画"><span class="toc-number">2.6.</span> <span class="toc-text">2.6 路由配合动画</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第三章-vuex"><span class="toc-number">3.</span> <span class="toc-text">第三章: vuex</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-安装vuex"><span class="toc-number">3.1.</span> <span class="toc-text">3.1 安装vuex</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-vuex基础"><span class="toc-number">3.2.</span> <span class="toc-text">3.2 vuex基础</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-state"><span class="toc-number">3.2.1.</span> <span class="toc-text">1. state</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-getters"><span class="toc-number">3.2.2.</span> <span class="toc-text">2. getters</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-mutation"><span class="toc-number">3.2.3.</span> <span class="toc-text">3. mutation</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-action"><span class="toc-number">3.2.4.</span> <span class="toc-text">4. action</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-module"><span class="toc-number">3.2.5.</span> <span class="toc-text">5. module</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-vuex项目结构"><span class="toc-number">3.3.</span> <span class="toc-text">3.3 vuex项目结构</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第四章-http相关"><span class="toc-number">4.</span> <span class="toc-text">第四章: http相关</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-promise"><span class="toc-number">4.1.</span> <span class="toc-text">4.1 promise</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-传统的异步操作转promise"><span class="toc-number">4.1.1.</span> <span class="toc-text">2. 传统的异步操作转promise</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-ES7的Async-Await"><span class="toc-number">4.2.</span> <span class="toc-text">4.2  ES7的Async/Await</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-基本规则"><span class="toc-number">4.2.1.</span> <span class="toc-text">1. 基本规则</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-获得返回值"><span class="toc-number">4.2.2.</span> <span class="toc-text">2. 获得返回值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-捕捉错误"><span class="toc-number">4.2.3.</span> <span class="toc-text">3. 捕捉错误</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-循环多个await"><span class="toc-number">4.2.4.</span> <span class="toc-text">4. 循环多个await</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-vue-resource"><span class="toc-number">4.3.</span> <span class="toc-text">4.3 vue-resource</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-安装使用vue-resource"><span class="toc-number">4.3.1.</span> <span class="toc-text">1. 安装使用vue-resource</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-http的方法"><span class="toc-number">4.3.2.</span> <span class="toc-text">3. http的方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-get"><span class="toc-number">4.3.3.</span> <span class="toc-text">4. get</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-使用axios"><span class="toc-number">4.3.4.</span> <span class="toc-text">1. 使用axios</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-利用axios跨域"><span class="toc-number">4.3.5.</span> <span class="toc-text">2. 利用axios跨域</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第五章-json-server插件"><span class="toc-number">5.</span> <span class="toc-text">第五章: json-server插件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-使用json-server"><span class="toc-number">5.1.</span> <span class="toc-text">5.1 使用json-server</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-设置常用路由地址"><span class="toc-number">5.2.</span> <span class="toc-text">5.3 设置常用路由地址</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-json-server的关系图谱"><span class="toc-number">5.3.</span> <span class="toc-text">5.4 json-server的关系图谱</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-只获取下级资源"><span class="toc-number">5.3.1.</span> <span class="toc-text">3. 只获取下级资源</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第六章-mockjs"><span class="toc-number">6.</span> <span class="toc-text">第六章: mockjs</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-基本使用"><span class="toc-number">6.1.</span> <span class="toc-text">6.1 基本使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-mockjs配合fs写入数据"><span class="toc-number">6.2.</span> <span class="toc-text">6.2 mockjs配合fs写入数据</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第七章-json-mockjs-http案例"><span class="toc-number">7.</span> <span class="toc-text">第七章: json+mockjs+http案例</span></a></li></ol>
</div>
<div class="toc-button" onclick="toggleTOC(event);" ontouchstart="toggleTOC(event);">
    <img src="/images/icons/blue-shadow/toc.svg" alt="">
</div>

	</div>
	
	<div class="nav-item" id="nav-item-archive">
		
				<div class="nav-icon">
				
			<a href="/archives/" title="归档">
			<img src="/images/icons/blue-shadow/archive.svg" alt="">
			</a>
		</div>
	</div>
	<div class="nav-item" id="nav-item-search">
		
		<div class="nav-icon">
		
			<a href="/search/" title="搜索">
			<img src="/images/icons/blue-shadow/search.svg" alt="">
			</a>
		</div>
	</div>
	<div class="nav-item" id="nav-item-more">
		<div class="nav-icon">
				<a href="#" onclick="onClickMenuIcon(event);" ontouchstart="onClickMenuIcon(event);">
				<img src="/images/icons/blue-shadow/menu.svg" alt="">
				</a>
		</div>
		<div class="nav-more-menu">
				<i class="far fa-times-circle" id="nav-more-menu-close" onclick="onClickNavMenuClose(event);" ontouchstart="onClickNavMenuClose(event);"></i>
		
			
			
				
			
				
			
				
			
				
			
				
			
				
			
		
			<div class="nav-more-item">
					<div class="nav-name">
						<a class="nav-link" href="/home/">
							<span>首页</span>
						</a>
					</div>
			</div>
		
		
			
			
				
			
				
			
				
			
				
			
				
			
				
			
		
			<div class="nav-more-item">
					<div class="nav-name">
						<a class="nav-link" href="/about/">
							<span>关于</span>
						</a>
					</div>
			</div>
		
		
		
		<div class="nav-more-item">
				<div class="nav-name">
					<a class="nav-link" href="/categories/mySql/">
						<span>Mysql</span>
					</a>
				</div>
		</div>
		
		<div class="nav-more-item">
				<div class="nav-name">
					<a class="nav-link" href="/categories/php/">
						<span>Php</span>
					</a>
				</div>
		</div>
		
		<div class="nav-more-item">
				<div class="nav-name">
					<a class="nav-link" href="/categories/其它技能/">
						<span>其它技能</span>
					</a>
				</div>
		</div>
		
		<div class="nav-more-item">
				<div class="nav-name">
					<a class="nav-link" href="/categories/vscode/">
						<span>Vscode</span>
					</a>
				</div>
		</div>
		
		<div class="nav-more-item">
				<div class="nav-name">
					<a class="nav-link" href="/categories/前端进阶/">
						<span>前端进阶</span>
					</a>
				</div>
		</div>
		
		<div class="nav-more-item">
				<div class="nav-name">
					<a class="nav-link" href="/categories/前端入门/">
						<span>前端入门</span>
					</a>
				</div>
		</div>
		
	</div>
	</div>
</nav>

	</div>
</header>

 

  




  <!-- Primary Page Layout
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <div style="flex: 1;">
      <style>
    body {
        background-color: white;
    }
</style>




	
	
	
	



    
        
            
            
        
    






    
    
        
    

    
        
    









<article class="article" id="/2017/03/09/webNotes/primary/Vue/vue-cli/" data-name="vue-cli" data-version="">

    <!-- Title -->
    <div class="article-header">
         
         <div class="article-logo">
            <a href="#" data-no-instant="">
                <img src="/images/vue.svg" alt="" onerror="if(this.src != " images="" uncategorized.svg")="" this.src="/images/uncategorized.svg" "="">
            </a>
         </div>
         
         <h1 class="article-title">
            <a href="/2017/03/09/webNotes/primary/Vue/vue-cli/">
                Vue-Cli
            </a>
        </h1>
        <!-- TODO: support nested categories,display them nicely -->
        
        <ul class="article-categories">
            
            
                <li><a href="/categories/前端入门/" data-no-instant="">
                    <img src="/images/前端入门.svg" alt="前端入门" onerror="if(this.src != " images="" uncategorized.svg")="" this.src="/images/uncategorized.svg" "="" title="前端入门">
                </a></li>
            
        </ul>
        
    </div>
    
    <!-- Date and Author -->
    <div class="article-meta">
    <ul>
            <li><i class="fa fa-calendar"></i> 2017年03月09日</li>
            
            <li class="comment-button"><a href="#article-comment"><i class="fa fa-comments"></i> <span id="article-comment-count">0</span></a></li>
            <li><i class="fa fa-eye"></i> <span id="article-visit-count">0</span></li>
            <li class="thumb-up-button" id="thumb-up-button"><i class="far fa-thumbs-up fa-lg" id="thumb-up-icon"></i> <span id="article-thumbup-count">0</span></li>
            
            <li><i class="fa fa-user"></i> LinDaiDai</li>
            <li><i class="fas fa-copyright"></i>
            
                
                
            
            
                
                    
                
                <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh">CC BY-NC-ND 4.0</a>
            
            </li>
    </ul>
    
<div class="tags">
	
		
			<label class="tag-1"><a href="/tags/vue/">Vue</a></label>
		
	
		
			<label class="tag-2"><a href="/tags/前端入门/">前端入门</a></label>
		
	
	</div>

    </div>
    <div class="article-cards">
        <!-- Author Card -->
        <!---
        <div class='Card-article Card-author'>
            <div class='card-title'>
                <h3></h3>
            </div>
            <div class='card-content'>
                    <div class="author-meta">
                            <div class='author-figure'>
                                <img src="" alt="">
                            </div>
                            <div class='author-name'>
                                LinDaiDai
                            </div>
                        </div>
                        <div class="author-ai">
                            <div class='author-intro'>
                                <!-- TODO: auto generating author description -->
                                <!-- 
                            </div>
                            <div class="author-articles">
                                <!-- TODO: auto generating author articles -->
                                <!-- <ul>
                                    <li>Article 1</li>
                                    <li>Article 2</li>
                                    <li>Article 3</li>
                                    <li>Article 4</li>
                                    <li>Article 5</li>
                                    <li>Article 6</li>
                                </ul>
                            </div>
                        </div>
            </div>
            
        </div> -->

        <!-- Visit Card -->
        <!-- <div class="Card-article Card-visit"> -->
            <!-- <div class="card-title">
  <h3>Post Visit</h3>
</div>
<div class="card-chart">
  <div id="chart-post-visit"></div>
</div> -->
        <!-- </div> -->
        
        <!-- Auto Excerpt Card -->
        <!-- <div class="Card-article Card-excerpt">
            <div class="card-title">
  <h3>Quick Read</h3>
</div>
<div class="card-text">
  <p id="text-post-summary">第一章: 项目运行1.webpack.build.js进行所有的js文件打包
​    文件夹名build
​    其中webpack.base.conf中的module.exports={}:
12345678910111213141516module.exports = &#123;  entry: &#123;      //入口文件    app: &apos;./src/main.js&apos;    &#125;,  output: &#123;    path: config.build.assetsRoot,    filename:...</p>
</div>
        </div> -->
    </div>
    
    <!-- Gallery -->
    <!-- TODO: add a slider to gallery -->
    

    <!-- Content -->
    <!-- TODO: support table of content -->
    <div class="article-toc" id="article-toc">
    
        


<div class="toc-container">
<i class="far fa-times-circle" id="toc-close" onclick="closeTOC(event);" ontouchstart="closeTOC(event);"></i>
<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#第一章-项目运行"><span class="toc-number">1.</span> <span class="toc-text">第一章: 项目运行</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第二章-router"><span class="toc-number">2.</span> <span class="toc-text">第二章: router</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-基本使用"><span class="toc-number">2.1.</span> <span class="toc-text">2.1 基本使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-案例1"><span class="toc-number">2.2.</span> <span class="toc-text">2.2 案例1:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-通过js控制跳转"><span class="toc-number">2.3.</span> <span class="toc-text">2.3 通过js控制跳转</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-路由器嵌套"><span class="toc-number">2.4.</span> <span class="toc-text">2.4 路由器嵌套</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-案例"><span class="toc-number">2.4.1.</span> <span class="toc-text">1. 案例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-重定向"><span class="toc-number">2.5.</span> <span class="toc-text">2.5 重定向</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-6-路由配合动画"><span class="toc-number">2.6.</span> <span class="toc-text">2.6 路由配合动画</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第三章-vuex"><span class="toc-number">3.</span> <span class="toc-text">第三章: vuex</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-安装vuex"><span class="toc-number">3.1.</span> <span class="toc-text">3.1 安装vuex</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-vuex基础"><span class="toc-number">3.2.</span> <span class="toc-text">3.2 vuex基础</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-state"><span class="toc-number">3.2.1.</span> <span class="toc-text">1. state</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-getters"><span class="toc-number">3.2.2.</span> <span class="toc-text">2. getters</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-mutation"><span class="toc-number">3.2.3.</span> <span class="toc-text">3. mutation</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-action"><span class="toc-number">3.2.4.</span> <span class="toc-text">4. action</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-module"><span class="toc-number">3.2.5.</span> <span class="toc-text">5. module</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-vuex项目结构"><span class="toc-number">3.3.</span> <span class="toc-text">3.3 vuex项目结构</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第四章-http相关"><span class="toc-number">4.</span> <span class="toc-text">第四章: http相关</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-promise"><span class="toc-number">4.1.</span> <span class="toc-text">4.1 promise</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-传统的异步操作转promise"><span class="toc-number">4.1.1.</span> <span class="toc-text">2. 传统的异步操作转promise</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-ES7的Async-Await"><span class="toc-number">4.2.</span> <span class="toc-text">4.2  ES7的Async/Await</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-基本规则"><span class="toc-number">4.2.1.</span> <span class="toc-text">1. 基本规则</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-获得返回值"><span class="toc-number">4.2.2.</span> <span class="toc-text">2. 获得返回值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-捕捉错误"><span class="toc-number">4.2.3.</span> <span class="toc-text">3. 捕捉错误</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-循环多个await"><span class="toc-number">4.2.4.</span> <span class="toc-text">4. 循环多个await</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-vue-resource"><span class="toc-number">4.3.</span> <span class="toc-text">4.3 vue-resource</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-安装使用vue-resource"><span class="toc-number">4.3.1.</span> <span class="toc-text">1. 安装使用vue-resource</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-http的方法"><span class="toc-number">4.3.2.</span> <span class="toc-text">3. http的方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-get"><span class="toc-number">4.3.3.</span> <span class="toc-text">4. get</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-使用axios"><span class="toc-number">4.3.4.</span> <span class="toc-text">1. 使用axios</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-利用axios跨域"><span class="toc-number">4.3.5.</span> <span class="toc-text">2. 利用axios跨域</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第五章-json-server插件"><span class="toc-number">5.</span> <span class="toc-text">第五章: json-server插件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-使用json-server"><span class="toc-number">5.1.</span> <span class="toc-text">5.1 使用json-server</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-设置常用路由地址"><span class="toc-number">5.2.</span> <span class="toc-text">5.3 设置常用路由地址</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-json-server的关系图谱"><span class="toc-number">5.3.</span> <span class="toc-text">5.4 json-server的关系图谱</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-只获取下级资源"><span class="toc-number">5.3.1.</span> <span class="toc-text">3. 只获取下级资源</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第六章-mockjs"><span class="toc-number">6.</span> <span class="toc-text">第六章: mockjs</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-基本使用"><span class="toc-number">6.1.</span> <span class="toc-text">6.1 基本使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-mockjs配合fs写入数据"><span class="toc-number">6.2.</span> <span class="toc-text">6.2 mockjs配合fs写入数据</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第七章-json-mockjs-http案例"><span class="toc-number">7.</span> <span class="toc-text">第七章: json+mockjs+http案例</span></a></li></ol>
</div>
<div class="toc-button" onclick="toggleTOC(event);" ontouchstart="toggleTOC(event);">
    <img src="/images/icons/blue-shadow/toc.svg" alt="">
</div>

    </div>
    <div class="article-content">
    <h2 id="第一章-项目运行"><a href="#第一章-项目运行" class="headerlink" title="第一章: 项目运行"></a>第一章: 项目运行</h2><p>1.webpack.build.js进行所有的js文件打包</p>
<p>​    文件夹名build</p>
<p>​    其中<code>webpack.base.conf</code>中的<code>module.exports={}</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">  entry: &#123;      //入口文件</span><br><span class="line">    app: &apos;./src/main.js&apos;  </span><br><span class="line">  &#125;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    path: config.build.assetsRoot,</span><br><span class="line">    filename: &apos;[name].js&apos;,      //打包以后输出的文件名称,(输出配置)</span><br><span class="line">  &#125;,</span><br><span class="line">  module: &#123;					//用以解析模块的一些规则</span><br><span class="line">    rules: &#123;</span><br><span class="line">      </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  resolve: &#123;				//读取文件的一些配置</span><br><span class="line">    </span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>2.利用webpack.config.js来进行命令的简化处理</p>
<p>​    这个文件就是webpack的默认配置文件,也就是文件夹名为config</p>
<p>3.利用webpack打包css</p>
<p>​    webpack本身不支持css打包. 依赖于<code>style-loader</code>和<code>css-loader</code>(使用webpack下载下来的文件中自带)</p>
<p>4.安装less-loader(需手动安装)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i less less-loader --save-dev</span><br></pre></td></tr></table></figure>
<p>5.安装vuex</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install vuex --save</span><br></pre></td></tr></table></figure>
<p>6.安装axios</p>
<p>​    用到http时需要安装axios</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save axios</span><br></pre></td></tr></table></figure>
<p>项目的入口文件是<code>main.js</code>,然后在<code>main.js</code>中依赖<code>app.vue</code>.<code>app.vue</code>中又依赖了<code>hello.vue</code>这个组件。</p>
<p>一个标准组件的构成就是由<code>template,script,style</code>这三个标签构成，</p>
<p>如果要在<code>app.vue</code>中使用<code>hello.vue</code>这个组件的话，需要把hello定义为app的子组件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import Hello from &apos;./components/Hello&apos;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  name: &apos;app&apos;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    Hello</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="第二章-router"><a href="#第二章-router" class="headerlink" title="第二章: router"></a>第二章: router</h2><p>根据不同的地址跳转到不同的页面，提到前端路由就不得不提SPA单页应用，单页面应用就是视觉感觉是页面的切换，但页面其实一直没有刷新，我们是通过js来让页面看起来好像是跳转到了另外一个页面。</p>
<h3 id="2-1-基本使用"><a href="#2-1-基本使用" class="headerlink" title="2.1 基本使用"></a>2.1 基本使用</h3><ul>
<li>在终端中进入到你的项目目录: <code>cd 项目路径</code></li>
<li>在项目目录下执行：<code>npm install vue-router --save</code>。后面加上<code>--save</code>的原因是要将<code>vue-router</code>添加到<code>package.json</code>的依赖中</li>
<li>然后在可以项目中引入<code>vue-router</code>，比如在<code>main.js</code>中</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// The Vue build version to load with the `import` command</span></span><br><span class="line"><span class="comment">// (runtime-only or standalone) has been set in webpack.base.conf with an alias.</span></span><br><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./App'</span></span><br><span class="line"><span class="comment">// 1.引入vue-router及组件</span></span><br><span class="line"><span class="keyword">import</span> Router <span class="keyword">from</span> <span class="string">'vue-router'</span></span><br><span class="line"><span class="keyword">import</span> Hello <span class="keyword">from</span> <span class="string">'./components/Hello'</span></span><br><span class="line"><span class="keyword">import</span> Orange <span class="keyword">from</span> <span class="string">'./components/Orange'</span></span><br><span class="line"><span class="keyword">import</span> Banana <span class="keyword">from</span> <span class="string">'./components/Banana'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.使用vue-router</span></span><br><span class="line">Vue.use(Router)</span><br><span class="line"><span class="comment">// 3.实例化router这个类</span></span><br><span class="line"><span class="keyword">let</span> router = <span class="keyword">new</span> Router(&#123;</span><br><span class="line">    <span class="comment">// 5.做映射,什么样的地址,跳转到什么样的页面</span></span><br><span class="line">    routes:[</span><br><span class="line">        &#123;</span><br><span class="line">              <span class="comment">// path:路径</span></span><br><span class="line">            path:<span class="string">'/'</span>,</span><br><span class="line">              <span class="comment">// 跳转的组件</span></span><br><span class="line">            component:Hello</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            path:<span class="string">'/orange'</span>,</span><br><span class="line">            component:Orange</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            path:<span class="string">'/banana'</span>,</span><br><span class="line">            component:Banana</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">Vue.config.productionTip = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* eslint-disable no-new */</span></span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">'#app'</span>,</span><br><span class="line">  <span class="comment">// 4.在vue实例中使用router</span></span><br><span class="line">  router:router,</span><br><span class="line">  template: <span class="string">'&lt;App/&gt;'</span>,</span><br><span class="line">  components: &#123; App &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>然后在<code>app.vue</code>中指定路由的位置，使用<code>router-view</code>这个组件</p>
<h3 id="2-2-案例1"><a href="#2-2-案例1" class="headerlink" title="2.2 案例1:"></a>2.2 案例1:</h3><p>1.在vue文件夹的目录下,执行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vue init webpack route_demo</span><br></pre></td></tr></table></figure>
<p>先不安装router</p>
<p>2.进入到route_demo文件夹下,执行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm i</span><br></pre></td></tr></table></figure>
<p>安装依赖</p>
<p>3.进入到route_demo文件夹下,执行</p>
<p>–save保存到生产环境</p>
<p>–dev保存到开发环境</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i vue-router@^2 --save</span><br></pre></td></tr></table></figure>
<p>文件夹下会多出</p>
<p>4.项目中引入<code>vue-router</code></p>
<p>在<code>main.js</code>中:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// The Vue build version to load with the `import` command</span></span><br><span class="line"><span class="comment">// (runtime-only or standalone) has been set in webpack.base.conf with an alias.</span></span><br><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./App'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 引入helloword组件</span></span><br><span class="line"><span class="keyword">import</span> Hello <span class="keyword">from</span> <span class="string">'@/components/HelloWorld'</span></span><br><span class="line"><span class="comment">// 引入orange组件</span></span><br><span class="line"><span class="keyword">import</span> Orange <span class="keyword">from</span> <span class="string">'@/components/Orange'</span></span><br><span class="line"><span class="comment">// 引入banana组件</span></span><br><span class="line"><span class="keyword">import</span> Banana <span class="keyword">from</span> <span class="string">'@/components/Banana'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 1.引入vue-router</span></span><br><span class="line"><span class="keyword">import</span> Router <span class="keyword">from</span> <span class="string">'vue-router'</span></span><br><span class="line"><span class="comment">// 2.在vue调用(使用)vue-router</span></span><br><span class="line">Vue.use(Router)</span><br><span class="line"><span class="comment">// 3.初始化(实例化)vue-router</span></span><br><span class="line"><span class="keyword">var</span> router = <span class="keyword">new</span> Router(&#123;</span><br><span class="line">  <span class="comment">// 配置表</span></span><br><span class="line">  <span class="comment">// 将路由模式切换为html5的history模式,可以将地址栏中的#去掉</span></span><br><span class="line">  mode: <span class="string">'history'</span>,</span><br><span class="line">  <span class="comment">// 5.配置路由,做映射，什么样的地址，跳转到什么的页面(组件)</span></span><br><span class="line">  routes: [</span><br><span class="line">    &#123;</span><br><span class="line">      path: <span class="string">'/'</span>,</span><br><span class="line">      <span class="comment">// component-&gt;ng中的templateUrl</span></span><br><span class="line">      component: Hello</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      path: <span class="string">'/orange'</span>,</span><br><span class="line">      name: <span class="string">'orange'</span>,</span><br><span class="line">      component: Orange</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      path: <span class="string">'/banana'</span>,</span><br><span class="line">      name: <span class="string">'banana'</span>,</span><br><span class="line">      component: Banana</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">Vue.config.productionTip = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* eslint-disable no-new */</span></span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">'#app'</span>,</span><br><span class="line">  <span class="comment">// 4.在vue实例中使用router,键名必须为router</span></span><br><span class="line">  router,</span><br><span class="line">  template: <span class="string">'&lt;App/&gt;'</span>,</span><br><span class="line">  components: &#123; App &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>5.在components文件夹中创建<code>orange</code>和<code>banana</code>俩个组件</p>
<p>如在orange中:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"orange"</span>&gt;</span><br><span class="line">    &lt;h1&gt;&#123;&#123;title&#125;&#125;&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>div&gt;</span><br><span class="line">&lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp">&lt;script&gt;</span></span><br><span class="line"><span class="regexp">export default &#123;</span></span><br><span class="line"><span class="regexp">  data () &#123;</span></span><br><span class="line"><span class="regexp">    return &#123;</span></span><br><span class="line"><span class="regexp">      title: '橙子'</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">&lt;/</span>script&gt;</span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.orange&#123;</span><br><span class="line">  color: orange;</span><br><span class="line">&#125;</span><br><span class="line">&lt;<span class="regexp">/style&gt;</span></span><br></pre></td></tr></table></figure>
<p>6.路由中的跳转(3种方式)</p>
<p>1.在要实现路由的地方使用<code>&lt;router-link to=&quot;/path&quot;&gt; &lt;/router-link&gt;</code></p>
<p>2.在要实现路由的地方使用<code>&lt;router-link :to=&quot;{path:path}&quot;&gt;&lt;/router-link&gt;</code></p>
<p>3.在要实现路由的地方使用<code>&lt;router-link :to=&quot;{name: name}&quot;&gt;&lt;/router-link&gt;</code>(需要在设置路由的地方加上name属性)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id=<span class="string">"app"</span>&gt;</span><br><span class="line">    &lt;img src=<span class="string">"./assets/logo.png"</span>&gt;</span><br><span class="line">    &lt;router-link to=<span class="string">'/'</span>&gt;首页&lt;<span class="regexp">/router-link&gt;</span></span><br><span class="line"><span class="regexp">    &lt;router-link to='/</span>orange<span class="string">'&gt;orange&lt;/router-link&gt;	// to中填入的是你在main.js的path设置的路径</span></span><br><span class="line"><span class="string">    &lt;--&lt;router-link :to="&#123;path:'</span>orange<span class="string">'&#125;"&gt;orange&lt;/router-link&gt;--&gt;</span></span><br><span class="line"><span class="string">    &lt;--&lt;router-link :to="&#123;name: '</span>orange<span class="string">'&#125;"&gt;orange&lt;/router-link&gt;--&gt;</span></span><br><span class="line"><span class="string">    &lt;router-link to='</span>/banana<span class="string">'&gt;banana&lt;/router-link&gt;</span></span><br><span class="line"><span class="string">    &lt;router-view&gt;&lt;/router-view&gt;</span></span><br><span class="line"><span class="string">  &lt;/div&gt;</span></span><br><span class="line"><span class="string">&lt;/template&gt;</span></span><br><span class="line"><span class="string">&lt;script&gt;</span></span><br><span class="line"><span class="string">export default &#123;</span></span><br><span class="line"><span class="string">  name: '</span>app<span class="string">',</span></span><br><span class="line"><span class="string">  components: &#123;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;style&gt;</span></span><br><span class="line"><span class="string">#app &#123;</span></span><br><span class="line"><span class="string">  font-family: '</span>Avenir<span class="string">', Helvetica, Arial, sans-serif;</span></span><br><span class="line"><span class="string">  -webkit-font-smoothing: antialiased;</span></span><br><span class="line"><span class="string">  -moz-osx-font-smoothing: grayscale;</span></span><br><span class="line"><span class="string">  text-align: center;</span></span><br><span class="line"><span class="string">  color: #2c3e50;</span></span><br><span class="line"><span class="string">  margin-top: 60px;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&lt;/style&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="2-3-通过js控制跳转"><a href="#2-3-通过js控制跳转" class="headerlink" title="2.3 通过js控制跳转"></a>2.3 通过js控制跳转</h3><p>在上面的案例中,我们是通过<code>router-link</code>标签自动转换为<code>a</code>标签来实现页面的跳转的,也可以通过js给任何元素添加事件来实现跳转:</p>
<p>1.给要跳转的元素添加事件:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;button @click=&quot;toBanana&quot;&gt;点击跳转&lt;/button&gt;</span><br></pre></td></tr></table></figure>
<p>2.编写js代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &apos;app&apos;,</span><br><span class="line">  components: &#123;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    toBanana () &#123;</span><br><span class="line">      // this.$router.push(&apos;banana&apos;)	</span><br><span class="line">      // this.$router.push(&#123;path: &apos;banana&apos;&#125;)</span><br><span class="line">      this.$router.push(&#123;name: &apos;banana&apos;&#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h3 id="2-4-路由器嵌套"><a href="#2-4-路由器嵌套" class="headerlink" title="2.4 路由器嵌套"></a>2.4 路由器嵌套</h3><p>有时候在路由器的内部需要嵌套路由器,</p>
<h4 id="1-案例"><a href="#1-案例" class="headerlink" title="1. 案例"></a>1. 案例</h4><p>比如在上面例子中的<code>Orange.vue</code>需要添加一个<code>RedOrange.vue</code>子路由器</p>
<p>1.编写<code>RedOrange.vue</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"redOrange"</span>&gt;</span><br><span class="line">    &lt;h1&gt;&#123;&#123;title&#125;&#125;&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>div&gt;</span><br><span class="line">&lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp">&lt;script&gt;</span></span><br><span class="line"><span class="regexp">export default &#123;</span></span><br><span class="line"><span class="regexp">  data () &#123;</span></span><br><span class="line"><span class="regexp">    return &#123;</span></span><br><span class="line"><span class="regexp">      title: '红色橙子'</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">&lt;/</span>script&gt;</span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.redOrange&#123;</span><br><span class="line">  color: red;</span><br><span class="line">&#125;</span><br><span class="line">&lt;<span class="regexp">/style&gt;</span></span><br></pre></td></tr></table></figure>
<p>2.在配置<code>orange</code>路由的地方添加<code>children</code>属性,然后<code>red</code>作为它的子路由</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">// 引入orange组件</span><br><span class="line">import Orange from &apos;@/components/Orange&apos;</span><br><span class="line">//1. 引入redOrange </span><br><span class="line">import RedOrange from &apos;@/components/RedOrange&apos;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">var router = new Router(&#123;</span><br><span class="line">	...</span><br><span class="line">  routes: [</span><br><span class="line">    &#123;</span><br><span class="line">      path: &apos;/&apos;,</span><br><span class="line">      // component-&gt;ng中的templateUrl</span><br><span class="line">      component: Hello</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      path: &apos;/orange&apos;,</span><br><span class="line">      name: &apos;orange&apos;,</span><br><span class="line">      component: Orange,</span><br><span class="line">      children: [		// 2. 配置red</span><br><span class="line">        &#123;</span><br><span class="line">          path:&apos;red&apos;,	//这里的path不用加&apos;/&apos;,因为以 / 开头的嵌套路径会被当作根路径</span><br><span class="line">          component: RedOrange</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>3.在需要显示子路由的地方添加<code>router-view</code>(这里再Orange.vue中显示,所以在上面的Orange.vue中添加)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"orange"</span>&gt;</span><br><span class="line">    &lt;h1&gt;&#123;&#123;title&#125;&#125;&lt;<span class="regexp">/h1&gt;	</span></span><br><span class="line"><span class="regexp">    &lt;router-view&gt;&lt;/</span>router-view&gt;</span><br><span class="line">  &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  data () &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      title: <span class="string">'橙子'</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp">&lt;style scoped&gt;</span></span><br><span class="line"><span class="regexp">.orange&#123;</span></span><br><span class="line"><span class="regexp">  color: orange;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">&lt;/</span>style&gt;</span><br></pre></td></tr></table></figure>
<p>4.在要触发跳转至<code>RedOrange</code>的地方,添加<code>&lt;router-link to=&quot;&quot;&gt;</code>,(这里直接在主页中添加)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id=<span class="string">"app"</span>&gt;</span><br><span class="line">    &lt;img src=<span class="string">"./assets/logo.png"</span>&gt;</span><br><span class="line">    &lt;router-link to=<span class="string">'/'</span>&gt;首页&lt;<span class="regexp">/router-link&gt;</span></span><br><span class="line"><span class="regexp">    &lt;router-link :to="&#123;name:'orange'&#125;"&gt;orange&lt;/</span>router-link&gt;</span><br><span class="line">    &lt;router-link to=<span class="string">'/banana'</span>&gt;banana&lt;<span class="regexp">/router-link&gt;</span></span><br><span class="line"><span class="regexp">    &lt;button @click="getBanana"&gt;点击按钮到banana&lt;/</span>button&gt;</span><br><span class="line">    &lt;router-link :to=<span class="string">"&#123;path:'/orange/red'&#125;"</span>&gt;redOrange&lt;<span class="regexp">/router-link&gt;		</span></span><br><span class="line"><span class="regexp">    &lt;router-view&gt;&lt;/</span>router-view&gt;</span><br><span class="line">  &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  name: <span class="string">'app'</span>,</span><br><span class="line">  components: &#123;</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    getBanana () &#123;</span><br><span class="line">        <span class="keyword">this</span>.$router.push(<span class="string">'banana'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp">&lt;style&gt;</span></span><br><span class="line"><span class="regexp">#app &#123;</span></span><br><span class="line"><span class="regexp">  font-family: 'Avenir', Helvetica, Arial, sans-serif;</span></span><br><span class="line"><span class="regexp">  -webkit-font-smoothing: antialiased;</span></span><br><span class="line"><span class="regexp">  -moz-osx-font-smoothing: grayscale;</span></span><br><span class="line"><span class="regexp">  text-align: center;</span></span><br><span class="line"><span class="regexp">  color: #2c3e50;</span></span><br><span class="line"><span class="regexp">  margin-top: 60px;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">&lt;/</span>style&gt;</span><br></pre></td></tr></table></figure>
<p><strong>注:点击redOrange跳转,可以看到地址栏变为了:<code>http://localhost:8080/orange/red</code></strong></p>
<h3 id="2-5-重定向"><a href="#2-5-重定向" class="headerlink" title="2.5 重定向"></a>2.5 重定向</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  path:&apos;/&apos;,</span><br><span class="line">  redirect:&apos;/orange&apos;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>redirect：重定向地址</p>
<h3 id="2-6-路由配合动画"><a href="#2-6-路由配合动画" class="headerlink" title="2.6 路由配合动画"></a>2.6 路由配合动画</h3><p>我们在进行路由切换的时候,可以直接就在<code>&lt;router-view&gt;&lt;/router-view&gt;</code>外面包上<code>transition</code>标签</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;transition name=<span class="string">"fade"</span>&gt;</span><br><span class="line">     &lt;router-view <span class="class"><span class="keyword">class</span></span>=<span class="string">"view"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span></span><br><span class="line"><span class="xml">   <span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.fade-enter-active</span>, <span class="selector-class">.fade-leave-active</span>&#123;</span><br><span class="line">  <span class="attribute">transition</span>: all <span class="number">1s</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.fade-enter</span>, <span class="selector-class">.fade-leave</span>&#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.view</span>&#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>使用animation.css</strong></p>
<p>1.使用CDN加速,</p>
<p>在index.html页面引入</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;link href="https://cdn.jsdelivr.net/npm/animate.css@3.5.1" rel="stylesheet" type="text/css"&gt;</span><br></pre></td></tr></table></figure>
<p>2.将<code>animation.css</code>文件放在<code>src/assets目录下</code></p>
<p>​    1.并在index.html页面引入</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;link href="./src/assets/animation.css" rel="stylesheet" type="text/css"&gt;</span><br></pre></td></tr></table></figure>
<p>​    2.或者在你要用到它的地方使用<code>import</code>调用</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="selector-tag">style</span>&gt;</span><br><span class="line">	@<span class="keyword">import</span> url(<span class="string">""</span>); </span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<h2 id="第三章-vuex"><a href="#第三章-vuex" class="headerlink" title="第三章: vuex"></a>第三章: vuex</h2><blockquote>
<p>Vuex 是一个专为 Vue.js 应用程序开发的<strong>状态管理模式</strong>。它采用集中式存储管理应用的所有组件的状态，并以相应的规则保证状态以一种可预测的方式发生变化。</p>
</blockquote>
<p><strong>什么情况下使用vuex?</strong></p>
<p>虽然 Vuex 可以帮助我们管理共享状态，但也附带了更多的概念和框架。这需要对短期和长期效益进行权衡。</p>
<p>如果您不打算开发大型单页应用，使用 Vuex 可能是繁琐冗余的。确实是如此——如果您的应用够简单，您最好不要使用 Vuex。一个简单的 <a href="https://cn.vuejs.org/v2/guide/components.html#非父子组件通信" target="_blank" rel="noopener">global event bus</a> 就足够您所需了。但是，如果您需要构建是一个中大型单页应用，您很可能会考虑如何更好地在组件外部管理状态，Vuex 将会成为自然而然的选择。</p>
<h3 id="3-1-安装vuex"><a href="#3-1-安装vuex" class="headerlink" title="3.1 安装vuex"></a>3.1 安装vuex</h3><p>在你项目文件目录下使用命令行:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install vuex --save</span><br></pre></td></tr></table></figure>
<blockquote>
<p>下载完后可以在<code>package.json</code>中查看到:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt; &quot;dependencies&quot;: &#123;</span><br><span class="line">&gt;     &quot;vue&quot;: &quot;^2.4.2&quot;,</span><br><span class="line">&gt;     &quot;vue-router&quot;: &quot;^2.7.0&quot;,</span><br><span class="line">&gt;     &quot;vuex&quot;: &quot;^3.0.0&quot;</span><br><span class="line">&gt;   &#125;,</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>每一个 Vuex 应用的核心就是 store（仓库）。“store”基本上就是一个容器，它包含着你的应用中大部分的<strong>状态 (state)</strong>。Vuex 和单纯的全局对象有以下两点不同：</p>
<ol>
<li>Vuex 的状态存储是响应式的。当 Vue 组件从 store 中读取状态的时候，若 store 中的状态发生变化，那么相应的组件也会相应地得到高效更新。</li>
<li>你不能直接改变 store 中的状态。改变 store 中的状态的唯一途径就是显式地<strong>提交 (commit) mutation</strong>。这样使得我们可以方便地跟踪每一个状态的变化，从而让我们能够实现一些工具帮助我们更好地了解我们的应用。</li>
</ol>
<blockquote>
<p>1.在src目录下创建文件夹store</p>
</blockquote>
<p>文件夹store中应该有</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. index.js</span><br><span class="line">2. actions.js</span><br><span class="line">3. getters.js</span><br><span class="line">4. mutations.js</span><br><span class="line">5. state.js</span><br></pre></td></tr></table></figure>
<blockquote>
<p>2.在index.js中要确保引用了vuex:</p>
<p>Vuex 通过 <code>store</code> 选项，提供了一种机制将状态从根组件“注入”到每一个子组件中（需调用 <code>Vue.use(Vuex)</code>）：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">//引入vue及vuex</span><br><span class="line">import Vue from &apos;vue&apos;</span><br><span class="line">import Vuex from &apos;vuex&apos;</span><br><span class="line"></span><br><span class="line">Vue.use(Vuex)</span><br><span class="line"></span><br><span class="line">import state from &apos;./state&apos;</span><br><span class="line">import actions from &apos;./actions&apos;</span><br><span class="line">import mutations from &apos;./mutations&apos;</span><br><span class="line">import getters from &apos;./getters&apos;</span><br><span class="line"></span><br><span class="line">export default new Vuex.Store(&#123;</span><br><span class="line">  state,</span><br><span class="line">  actions,</span><br><span class="line">  mutations,</span><br><span class="line">  getters</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>3.在<code>main.js</code>中要引用</p>
</blockquote>
<p>通过在根实例中注册 <code>store</code> 选项，该 store 实例会注入到根组件下的所有子组件中，且子组件能通过 <code>this.$store</code>访问到</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">new Vue(&#123;</span><br><span class="line">  el: &apos;#app&apos;,</span><br><span class="line">  router,</span><br><span class="line">  store,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>如想要获取<code>store</code>下的<code>state</code>中的<code>count</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> count = <span class="keyword">this</span>.$store.state.count</span><br></pre></td></tr></table></figure>
<h3 id="3-2-vuex基础"><a href="#3-2-vuex基础" class="headerlink" title="3.2 vuex基础"></a>3.2 vuex基础</h3><p>vuex核心理念:</p>
<ul>
<li><a href="https://vuex.vuejs.org/zh-cn/state.html" target="_blank" rel="noopener">State</a></li>
<li><a href="https://vuex.vuejs.org/zh-cn/getters.html" target="_blank" rel="noopener">Getter</a></li>
<li><a href="https://vuex.vuejs.org/zh-cn/mutations.html" target="_blank" rel="noopener">Mutation</a></li>
<li><a href="https://vuex.vuejs.org/zh-cn/actions.html" target="_blank" rel="noopener">Action</a></li>
<li><a href="https://vuex.vuejs.org/zh-cn/modules.html" target="_blank" rel="noopener">Module</a></li>
</ul>
<h4 id="1-state"><a href="#1-state" class="headerlink" title="1. state"></a>1. state</h4><p>单一状态树</p>
<p>一般用于储存初始化的一些数据</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">export default &#123;</span><br><span class="line">  // bannar</span><br><span class="line">  bannar: &#123;&#125;,</span><br><span class="line">  // 存储所有分类数据</span><br><span class="line">  classifys: [],</span><br><span class="line">  // 控制tabBar显示隐藏的</span><br><span class="line">  tabBarShow: true,</span><br><span class="line">  // 用户信息</span><br><span class="line">  userInfo: &#123;&#125;,</span><br><span class="line">  // 地址列表</span><br><span class="line">  sites: [],</span><br><span class="line">  // 所选城市</span><br><span class="line">  selectCity: '',</span><br><span class="line">  // 所选的地区</span><br><span class="line">  selectSite: '',</span><br><span class="line">  // 所选地区的坐标</span><br><span class="line">  location: &#123;&#125;,</span><br><span class="line">  // 购物车数据</span><br><span class="line">  carts: [],</span><br><span class="line">  // 控制购物车数量图标的动画</span><br><span class="line">  cartActive: false,</span><br><span class="line">  // 保存tabBar中cart标签的位置</span><br><span class="line">  cartPos: &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-getters"><a href="#2-getters" class="headerlink" title="2. getters"></a>2. getters</h4><blockquote>
<p>Vuex 允许我们在 store 中定义“getter”（可以认为是 store 的计算属性）。就像计算属性一样，getter 的返回值会根据它的依赖被缓存起来，且只有当它的依赖值发生了改变才会被重新计算。</p>
</blockquote>
<blockquote>
<p>也就是用于存储一些方法,这些方法用来返回需要计算的数据</p>
</blockquote>
<p>例如,存储了购物车中计算商品总数的方法</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">export default &#123;</span><br><span class="line">  // 获取购物车中的商品总数</span><br><span class="line">  cartsLen (state) &#123;</span><br><span class="line">    let result = 0</span><br><span class="line">    for (let i = 0; i <span class="tag">&lt; <span class="attr">state.carts.length</span>; <span class="attr">i</span>++) &#123;</span></span><br><span class="line"><span class="tag">      <span class="attr">if</span> (<span class="attr">state.carts</span>[<span class="attr">i</span>]<span class="attr">.selected</span>) &#123;</span></span><br><span class="line"><span class="tag">        <span class="attr">result</span> += <span class="string">state.carts[i].num</span></span></span><br><span class="line"><span class="tag">      &#125;</span></span><br><span class="line"><span class="tag">    &#125;</span></span><br><span class="line"><span class="tag">    <span class="attr">return</span> <span class="attr">result</span></span></span><br><span class="line"><span class="tag">  &#125;</span></span><br><span class="line"><span class="tag">&#125;</span></span><br></pre></td></tr></table></figure>
<h4 id="3-mutation"><a href="#3-mutation" class="headerlink" title="3. mutation"></a>3. mutation</h4><p>更改 Vuex 的 store 中的状态的唯一方法是提交 mutation</p>
<p><strong>mutation必须同步执行!</strong>    </p>
<p>Vuex 中的 mutation 非常类似于事件：每个 mutation 都有一个字符串的 <strong>事件类型 (type)</strong> 和 一个 <strong>回调函数 (handler)</strong>。这个回调函数就是我们实际进行状态更改的地方，并且它会接受 state 作为第一个参数：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">  state: &#123;</span><br><span class="line">    count: <span class="number">1</span></span><br><span class="line">  &#125;,</span><br><span class="line">  mutations: &#123;</span><br><span class="line">    increment (state) &#123;</span><br><span class="line">      <span class="comment">// 变更状态</span></span><br><span class="line">      state.count++</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>在上面的例子中,我们不能直接使用<code>store.increment</code>来调用函数,需要以相应的type调用store.commit方法:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">store.commit(&apos;increment&apos;)</span><br></pre></td></tr></table></figure>
<p>你可以向 <code>store.commit</code> 传入额外的参数，即 mutation 的 <strong>载荷（payload）</strong>：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ...</span></span><br><span class="line">mutations: &#123;</span><br><span class="line">  increment (state, n) &#123;</span><br><span class="line">    state.count += n</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">store.commit(<span class="string">'increment'</span>, <span class="number">10</span>)</span><br></pre></td></tr></table></figure>
<p>在大多数情况下，载荷应该是一个对象，这样可以包含多个字段并且记录的 mutation 会更易读：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ...</span></span><br><span class="line">mutations: &#123;</span><br><span class="line">  increment (state, payload) &#123;</span><br><span class="line">    state.count += payload.amount</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">store.commit(<span class="string">'increment'</span>, &#123;</span><br><span class="line">  amount: <span class="number">10</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>在实际中,会将mutations整合到一个js文件,并且每个要提交的函数都应该用大写命名,</p>
<p>如 : 向购物车添加商品</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ADD_PRODUCT_NUM (state, product) &#123;</span><br><span class="line">  state.carts.push(product)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<p>此函数会在action中定义</p>
<h4 id="4-action"><a href="#4-action" class="headerlink" title="4. action"></a>4. action</h4><p>Action 类似于 mutation，不同在于：</p>
<ul>
<li><p>Action 提交的是 mutation，而不是直接变更状态。</p>
</li>
<li><p>Action 可以包含任意异步操作。</p>
<p>Action 函数接受一个与 store 实例具有相同方法和属性的 context 对象，因此你可以调用 <code>context.commit</code> 提交一个 mutation，或者通过 <code>context.state</code> 和 <code>context.getters</code> 来获取 state 和 getters</p>
<p>让我们来注册一个简单的 action：</p>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">  state: &#123;</span><br><span class="line">    count: <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  mutations: &#123;</span><br><span class="line">    INCREMENT (state) &#123;</span><br><span class="line">      state.count++</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  actions: &#123;</span><br><span class="line">    increment (context) &#123;</span><br><span class="line">      context.commit(<span class="string">'INCREMENT'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>实践中，我们会经常用到 ES2015 的 <a href="https://github.com/lukehoban/es6features#destructuring" target="_blank" rel="noopener">参数解构</a> 来简化代码（特别是我们需要调用 <code>commit</code> 很多次的时候）：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">actions: &#123;</span><br><span class="line">  increment (&#123; commit &#125;) &#123;	//将上面的context换为&#123;commit&#125;</span><br><span class="line">    commit(&apos;INCREMENT&apos;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>那么我们怎么调用<code>increment</code>这个方法呢(也就是mutations中的INCREMENT方法)</p>
<blockquote>
<p>1.Action 通过 <code>store.dispatch</code> 方法触发：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; store.dispatch(<span class="string">'increment'</span>)		<span class="comment">//触发的就是Action中的increment方法</span></span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<p>2.在组件中使用 <code>this.$store.dispatch(&#39;xxx&#39;)</code> 分发 action</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; this.$store.dispatch(&apos;increment&apos;)</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<p>3.或者使用 <code>mapActions</code> 辅助函数将组件的 methods 映射为 <code>store.dispatch</code> 调用（需要先在根节点注入 <code>store</code>）：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import &#123; mapActions &#125; from &apos;vuex&apos;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  // ...</span><br><span class="line">  methods: &#123;</span><br><span class="line">    ...mapActions([</span><br><span class="line">      &apos;increment&apos;, // 将 `this.increment()` 映射为 `this.$store.dispatch(&apos;increment&apos;)`</span><br><span class="line"></span><br><span class="line">      // `mapActions` 也支持载荷：</span><br><span class="line">      &apos;incrementBy&apos; // 将 `this.incrementBy(amount)` 映射为 `this.$store.dispatch(&apos;incrementBy&apos;, amount)`</span><br><span class="line">    ]),</span><br><span class="line">    ...mapActions(&#123;</span><br><span class="line">      add: &apos;increment&apos; // 将 `this.add()` 映射为 `this.$store.dispatch(&apos;increment&apos;)`</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>乍一眼看上去感觉多此一举，我们直接分发 mutation 岂不更方便？实际上并非如此，还记得 <strong>mutation 必须同步执行</strong>这个限制么？Action 就不受约束！我们可以在 action 内部执行<strong>异步</strong>操作：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">actions: &#123;</span><br><span class="line">  incrementAsync (&#123; commit &#125;) &#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;				<span class="comment">//比如定时器这种异步操作</span></span><br><span class="line">      commit(<span class="string">'INCREMENT'</span>)</span><br><span class="line">    &#125;, <span class="number">1000</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Actions 支持同样的载荷方式和对象方式进行分发：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// 以载荷形式分发</span><br><span class="line">store.dispatch(&apos;incrementAsync&apos;, &#123;</span><br><span class="line">  amount: 10</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// 以对象形式分发</span><br><span class="line">store.dispatch(&#123;</span><br><span class="line">  type: &apos;incrementAsync&apos;,</span><br><span class="line">  amount: 10</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>来看一个更加实际的购物车示例，涉及到<strong>调用异步 API</strong> 和<strong>分发多重 mutation</strong>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">actions: &#123;</span><br><span class="line">  checkout (&#123; commit, state &#125;, products) &#123;</span><br><span class="line">    // 把当前购物车的物品备份起来</span><br><span class="line">    const savedCartItems = [...state.cart.added]</span><br><span class="line">    // 发出结账请求，然后乐观地清空购物车</span><br><span class="line">    commit(types.CHECKOUT_REQUEST)</span><br><span class="line">    // 购物 API 接受一个成功回调和一个失败回调</span><br><span class="line">    shop.buyProducts(</span><br><span class="line">      products,</span><br><span class="line">      // 成功操作</span><br><span class="line">      () =&gt; commit(types.CHECKOUT_SUCCESS),</span><br><span class="line">      // 失败操作</span><br><span class="line">      () =&gt; commit(types.CHECKOUT_FAILURE, savedCartItems)</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>组合 Action</strong></p>
<p>Action 通常是异步的，那么如何知道 action 什么时候结束呢？更重要的是，我们如何才能组合多个 action，以处理更加复杂的异步流程？</p>
<p>首先，你需要明白 <code>store.dispatch</code> 可以处理被触发的 action 的处理函数返回的 Promise，并且 <code>store.dispatch</code> 仍旧返回 Promise：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">store.dispatch(<span class="string">'actionA'</span>).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>在另外一个 action 中也可以：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">actions: &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  actionB (&#123; dispatch, commit &#125;) &#123;</span><br><span class="line">    <span class="keyword">return</span> dispatch(<span class="string">'actionA'</span>).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      commit(<span class="string">'someOtherMutation'</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="5-module"><a href="#5-module" class="headerlink" title="5. module"></a>5. module</h4><p>由于使用单一状态树，应用的所有状态会集中到一个比较大的对象。当应用变得非常复杂时，store 对象就有可能变得相当臃肿。</p>
<p>为了解决以上问题，Vuex 允许我们将 store 分割成<strong>模块（module）</strong>。每个模块拥有自己的 state、mutation、action、getter、甚至是嵌套子模块——从上至下进行同样方式的分割：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> moduleA = &#123;</span><br><span class="line">  state: &#123; ... &#125;,</span><br><span class="line">  mutations: &#123; ... &#125;,</span><br><span class="line">  actions: &#123; ... &#125;,</span><br><span class="line">  getters: &#123; ... &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> moduleB = &#123;</span><br><span class="line">  state: &#123; ... &#125;,</span><br><span class="line">  mutations: &#123; ... &#125;,</span><br><span class="line">  actions: &#123; ... &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">  modules: &#123;</span><br><span class="line">    a: moduleA,</span><br><span class="line">    b: moduleB</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">store.state.a <span class="comment">// -&gt; moduleA 的状态</span></span><br><span class="line">store.state.b <span class="comment">// -&gt; moduleB 的状态</span></span><br></pre></td></tr></table></figure>
<p>模块动态注册功能使得其他 Vue 插件可以通过在 store 中附加新模块的方式来使用 Vuex 管理状态。例如，<a href="https://github.com/vuejs/vuex-router-sync" target="_blank" rel="noopener"><code>vuex-router-sync</code></a> 插件就是通过动态注册模块将 vue-router 和 vuex 结合在一起，实现应用的路由状态管理。</p>
<h3 id="3-3-vuex项目结构"><a href="#3-3-vuex项目结构" class="headerlink" title="3.3 vuex项目结构"></a>3.3 vuex项目结构</h3><p>Vuex 并不限制你的代码结构。但是，它规定了一些需要遵守的规则：</p>
<ol>
<li>应用层级的状态应该集中到单个 store 对象中。</li>
<li>提交 <strong>mutation</strong> 是更改状态的唯一方法，并且这个过程是同步的。</li>
<li>异步逻辑都应该封装到 <strong>action</strong> 里面。</li>
</ol>
<p>只要你遵守以上规则，如何组织代码随你便。如果你的 store 文件太大，只需将 action、mutation 和 getter 分割到单独的文件。</p>
<p>对于大型应用，我们会希望把 Vuex 相关代码分割到模块中。下面是项目结构示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">├── index.html</span><br><span class="line">├── main.js</span><br><span class="line">├── api</span><br><span class="line">│   └── ... # 抽取出API请求</span><br><span class="line">├── components</span><br><span class="line">│   ├── App.vue</span><br><span class="line">│   └── ...</span><br><span class="line">└── store</span><br><span class="line">    ├── index.js          # 我们组装模块并导出 store 的地方</span><br><span class="line">    ├── actions.js        # 根级别的 action</span><br><span class="line">    ├── mutations.js      # 根级别的 mutation</span><br><span class="line">    └── modules</span><br><span class="line">        ├── cart.js       # 购物车模块</span><br><span class="line">        └── products.js   # 产品模块</span><br></pre></td></tr></table></figure>
<h2 id="第四章-http相关"><a href="#第四章-http相关" class="headerlink" title="第四章: http相关"></a>第四章: http相关</h2><h3 id="4-1-promise"><a href="#4-1-promise" class="headerlink" title="4.1 promise"></a>4.1 promise</h3><p>Promise 是异步编程的一种解决方案，比传统的解决方案——回调函数和事件——更合理和更强大</p>
<p>所谓<code>Promise</code>，简单说就是一个容器，里面保存着某个未来才会结束的事件（通常是一个异步操作）的结果。从语法上说，Promise 是一个对象，从它可以获取异步操作的消息。Promise 提供统一的 API，各种异步操作都可以用同样的方法进行处理。</p>
<p>####1. 基本语法:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">async</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//resolve异步操作成功时调用</span></span><br><span class="line">    <span class="comment">//reject失败时调用</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span> (<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(...) &#123;</span><br><span class="line">      reject(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'出错了'</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    setTimout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      resolve(a+b)</span><br><span class="line">    &#125;, <span class="number">1000</span>)</span><br><span class="line">    </span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span>(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">	.then(<span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'第一次返回的值'</span> + result)</span><br><span class="line">	&#125;, <span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'第一次的错误是'</span> + error)</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="2-传统的异步操作转promise"><a href="#2-传统的异步操作转promise" class="headerlink" title="2. 传统的异步操作转promise"></a>2. 传统的异步操作转promise</h4><p>传统写法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">async</span>(<span class="params">a,b,cb</span>)</span>&#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">        cb(a+b)</span><br><span class="line">    &#125;,<span class="number">200</span>)</span><br><span class="line">&#125;    </span><br><span class="line"><span class="keyword">async</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="function"><span class="keyword">function</span> (<span class="params">result</span>)</span>&#123;</span><br><span class="line">    <span class="comment">// 延迟200ms后执行</span></span><br><span class="line">    <span class="keyword">if</span> (result&gt;<span class="number">2</span>)&#123;</span><br><span class="line">        <span class="keyword">async</span>(result,<span class="number">2</span>,<span class="function"><span class="keyword">function</span>(<span class="params">result</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (result&gt;<span class="number">4</span>)&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(result)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>es6-promise写法：</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">async</span>(<span class="params">a,b</span>)</span>&#123;</span><br><span class="line">    <span class="comment">//resolve异步操作成功时调用</span></span><br><span class="line">    <span class="comment">//reject失败时调用</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> a !== <span class="string">"number"</span> ||<span class="keyword">typeof</span> b !== <span class="string">"number"</span>)&#123;</span><br><span class="line">            reject(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"不是一个number"</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">            resolve(a+b);</span><br><span class="line">        &#125;,<span class="number">1000</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//不管是成功或者失败都会调用then这个方法</span></span><br><span class="line"><span class="comment">//然后接受两个函数作为参数，第一个是成功的</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">promise:更加优雅，逻辑更加清晰</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">async</span>(<span class="number">1</span>,<span class="string">'a'</span>)</span><br><span class="line">    .then(<span class="function"><span class="keyword">function</span> (<span class="params">result</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"第一次返回的值"</span>+result)</span><br><span class="line">        <span class="keyword">if</span> (result &gt; <span class="number">2</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">async</span>(result,<span class="number">2</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,<span class="function"><span class="keyword">function</span> (<span class="params">error</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"第一次错误:"</span>+error)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">5</span>;</span><br><span class="line">    &#125;)</span><br><span class="line">    .then(<span class="function"><span class="keyword">function</span> (<span class="params">result</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"第二次返回的值"</span>+result)</span><br><span class="line">        <span class="keyword">if</span> (result &gt; <span class="number">4</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">async</span>(result,<span class="number">2</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .then(<span class="function"><span class="keyword">function</span> (<span class="params">result</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"第三次返回的值"</span>+result)</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">//catch捕获错误</span></span><br><span class="line">    .catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"第二次错误:"</span>+error)</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>
<h3 id="4-2-ES7的Async-Await"><a href="#4-2-ES7的Async-Await" class="headerlink" title="4.2  ES7的Async/Await"></a>4.2  ES7的Async/Await</h3><p>Async/Await应该是目前最简单的异步方案了</p>
<p>案例1:</p>
<p>要实现一个暂停功能，输入N毫秒，则停顿N毫秒后才继续往下执行。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sleep</span> (<span class="params">time</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>)) </span>&#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      resolve();</span><br><span class="line">    &#125;, time)</span><br><span class="line">  &#125;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> start = <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="comment">// 在这里使用起来就像同步代码那样直观</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'start'</span>)</span><br><span class="line">  <span class="keyword">await</span> sleep(<span class="number">3000</span>)</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'end)</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">start();</span></span><br><span class="line"><span class="string">async function start () &#123;</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">=&gt; 控制台先输出start，稍等3秒后，输出了end。</span><br></pre></td></tr></table></figure>
<p>在申明<code>start</code>函数时,也可以这样写:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">async function start () &#123;	// 表面这是一个async函数</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="1-基本规则"><a href="#1-基本规则" class="headerlink" title="1. 基本规则"></a>1. 基本规则</h4><blockquote>
<ol>
<li><p>async 表示<code>这是一个async函数</code>，<code>await只能用在这个函数里面</code>。</p>
<p>​</p>
</li>
<li><p>await 表示在这里<code>等待promise返回结果</code>了，再继续执行。</p>
<p>​</p>
</li>
<li><p>await 后面跟着的<code>应该是一个promise对象</code>（当然，其他返回值也没关系，只是会立即执行，不过那样就没有意义了…）</p>
</li>
</ol>
</blockquote>
<h4 id="2-获得返回值"><a href="#2-获得返回值" class="headerlink" title="2. 获得返回值"></a>2. 获得返回值</h4><p>await等待的虽然是promise对象，但不必写<code>.then(..)</code>，直接可以得到返回值。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> sleep = <span class="function"><span class="keyword">function</span> (<span class="params">time</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="comment">// 返回 ‘ok’</span></span><br><span class="line">            resolve(<span class="string">'ok'</span>);</span><br><span class="line">        &#125;, time);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> start = <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  	<span class="built_in">console</span>.log(<span class="string">'start'</span>)</span><br><span class="line">    <span class="keyword">let</span> result = <span class="keyword">await</span> sleep(<span class="number">1000</span>);	<span class="comment">//直接用一个变量来盛放返回值</span></span><br><span class="line">    <span class="built_in">console</span>.log(result); <span class="comment">// 收到 ‘ok’</span></span><br><span class="line">&#125;;</span><br><span class="line">start();</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">start</span><br><span class="line">=&gt;1秒后输出ok</span><br></pre></td></tr></table></figure>
<h4 id="3-捕捉错误"><a href="#3-捕捉错误" class="headerlink" title="3. 捕捉错误"></a>3. 捕捉错误</h4><p>既然<code>.then(..)</code>不用写了，那么<code>.catch(..)</code>也不用写，可以直接用标准的<code>try catch</code>语法捕捉错误。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> sleep = <span class="function"><span class="keyword">function</span> (<span class="params">time</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="comment">// 模拟出错了，返回 ‘error’</span></span><br><span class="line">            reject(<span class="string">'error'</span>);</span><br><span class="line">        &#125;, time);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> start = <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'start'</span>);</span><br><span class="line">        <span class="keyword">await</span> sleep(<span class="number">3000</span>); <span class="comment">// 这里得到了一个返回错误</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 所以以下代码不会被执行了</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'end'</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(err); <span class="comment">// 这里捕捉到错误 `error`</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="4-循环多个await"><a href="#4-循环多个await" class="headerlink" title="4. 循环多个await"></a>4. 循环多个await</h4><p>await看起来就像是同步代码，所以可以理所当然的写在<code>for</code>循环里，不必担心以往需要<code>闭包</code>才能解决的问题。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> sleep = <span class="function"><span class="keyword">function</span> (<span class="params">time</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="comment">// 返回 ‘ok’</span></span><br><span class="line">            resolve(<span class="string">'ok'</span>);</span><br><span class="line">        &#125;, time);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> start = <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt;= <span class="number">10</span>; i++) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`当前是第<span class="subst">$&#123;i&#125;</span>次等待..`</span>);</span><br><span class="line">        <span class="keyword">await</span> sleep(<span class="number">1000</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">当前是第<span class="number">1</span>次等待..</span><br><span class="line">当前是第<span class="number">2</span>次等待..</span><br><span class="line">当前是第<span class="number">3</span>次等待..</span><br><span class="line">当前是第<span class="number">4</span>次等待..</span><br><span class="line">...</span><br><span class="line">当前是第<span class="number">10</span>次等待..</span><br></pre></td></tr></table></figure>
<p><strong>值得注意的是，<code>await</code>必须在<code>async函数的上下文中</code>的。</strong></p>
<h3 id="4-3-vue-resource"><a href="#4-3-vue-resource" class="headerlink" title="4.3 vue-resource"></a>4.3 vue-resource</h3><h4 id="1-安装使用vue-resource"><a href="#1-安装使用vue-resource" class="headerlink" title="1. 安装使用vue-resource"></a>1. 安装使用vue-resource</h4><p>1.进入项目目录后安装vue-resource</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install vue-resource --save</span><br></pre></td></tr></table></figure>
<p>2.在要用的地方引入vue-resource,比如在<code>main.js</code>中    </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Resource <span class="keyword">from</span> <span class="string">'vue-resource'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//使用vue-resourece</span></span><br><span class="line">Vue.use(Resource)</span><br></pre></td></tr></table></figure>
<p>3.就可以开始使用<code>this.$http</code>来调用对应的方法</p>
<p>####2. 基本语法:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// global Vue object	(全局 Vue 对象)</span><br><span class="line">Vue.http.get(&apos;/someUrl&apos;, [options]).then(successCallback, errorCallback);</span><br><span class="line">Vue.http.post(&apos;/someUrl&apos;, [body], [options]).then(successCallback, errorCallback);</span><br><span class="line"></span><br><span class="line">//in a Vue instance		(Vue 实例)</span><br><span class="line">this.$http.get(&apos;/someUrl&apos;, [options]).then(successCallback, errorCallback);</span><br><span class="line">this.$http.post(&apos;/someUrl&apos;, [body], [options]).then(successCallback, errorCallback);</span><br></pre></td></tr></table></figure>
<p>比如调用get和post请求：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span><span class="keyword">get</span>:</span><br><span class="line">created () &#123;	<span class="comment">//created是vue中的生命周期中的在某个组件一创建时执行的代码</span></span><br><span class="line">  <span class="keyword">this</span>.$http.get(<span class="string">"db.json"</span>)		<span class="comment">//获取数据</span></span><br><span class="line">  	.then(<span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(result)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;  </span><br><span class="line"><span class="number">2.</span>post:</span><br><span class="line">created () &#123;</span><br><span class="line">  <span class="keyword">this</span>.$http.post(<span class="string">"db.json"</span>,&#123;<span class="attr">user</span>:<span class="string">'wang'</span>&#125;)		<span class="comment">//直接给db.json添加一条新数据</span></span><br><span class="line">    .then(<span class="function"><span class="keyword">function</span> (<span class="params">data</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="3-http的方法"><a href="#3-http的方法" class="headerlink" title="3. http的方法"></a>3. http的方法</h4><ul>
<li><code>get(url, [options])</code>    //获取数据</li>
<li><code>head(url, [options])</code></li>
<li><code>delete(url, [options])</code> //删除数据</li>
<li><code>jsonp(url, [options])</code></li>
<li><code>post(url, [body], [options])</code> //添加数据</li>
<li><code>put(url, [body], [options])</code> //更改数据</li>
<li><code>patch(url, [body], [options])</code></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="comment">// POST /someUrl</span></span><br><span class="line">  <span class="keyword">this</span>.$http.post(<span class="string">'/someUrl'</span>, &#123;<span class="attr">foo</span>: <span class="string">'bar'</span>&#125;).then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// get status</span></span><br><span class="line">    response.status;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// get status text</span></span><br><span class="line">    response.statusText;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// get 'Expires' header</span></span><br><span class="line">    response.headers.get(<span class="string">'Expires'</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// get body data</span></span><br><span class="line">    <span class="keyword">this</span>.someData = response.body;</span><br><span class="line"></span><br><span class="line">  &#125;, response =&gt; &#123;</span><br><span class="line">    <span class="comment">// error callback</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="4-get"><a href="#4-get" class="headerlink" title="4. get"></a>4. get</h4><p><strong>1. 属性值(Filter)</strong>    </p>
<p>使用 <code>.</code> 操作对象属性值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">getData () &#123;</span><br><span class="line">      this.$http.get(&apos;http://localhost:8081/products/2&apos;) //获取products数组下id为2的对象</span><br><span class="line">      this.$http.get(&apos;http://localhost:8081/products?name.length=3&apos;)//获取products数组下name长度为3的对象,并整合为一个数组</span><br><span class="line">      this.$http.get(&apos;http://localhost:8081/products?name.length=3&amp;description=3&apos;)/获取products数组下name长度为3的对象,并整合为一个数组</span><br><span class="line">      </span><br><span class="line">        .then(res =&gt; &#123;</span><br><span class="line">          console.log(res.body)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>
<p><strong>2. 分割(Slice)</strong></p>
<p>使用 <code>_start</code> 和 <code>_end</code> 或者 <code>_limit</code> (response中会包含 <code>X-Total-Count</code>)来获取对应的数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//id从3开始到6结束(不包过3)</span><br><span class="line">this.$http.get(&apos;http://localhost:8081/products?_start=3&amp;_end=6&apos;)</span><br><span class="line">id : 4 5 6</span><br><span class="line">//id从3开始获取5个(不包过3)</span><br><span class="line">this.$http.get(&apos;http://localhost:8081/products?_start=3&amp;_limit=5&apos;)</span><br><span class="line">id : 4 5 6 7 8</span><br></pre></td></tr></table></figure>
<p><strong>3. 排序(Sort)</strong></p>
<p>使用 <code>_sort</code> 和 <code>_order</code> (默认使用升序(ASC))</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//id按降序排列</span><br><span class="line">this.$http.get(&apos;http://localhost:8081/products?_sort=id&amp;_order=DESC&apos;)</span><br></pre></td></tr></table></figure>
<p><strong>4. 运算符(Operators)</strong>    </p>
<p>使用 <code>_gte</code> 或 <code>_lte</code> 选取一个范围</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// 选取浏览量在2000-2500之间的新闻</span><br><span class="line"></span><br><span class="line">GET /news?views_gte=2000&amp;views_lte=2500</span><br></pre></td></tr></table></figure>
<p>使用 <code>_ne</code> 排除一个值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// 选择tag属性不是 &quot;国际新闻&quot; 的分类</span><br><span class="line"></span><br><span class="line">GET /news?tag_ne=国际新闻</span><br></pre></td></tr></table></figure>
<p>使用 <code>_like</code> 进行模糊查找 (支持正则表达式)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// 查找title中含有 &quot;前端&quot; 字样的新闻 </span><br><span class="line"></span><br><span class="line">GET /news?title_like=前端</span><br></pre></td></tr></table></figure>
<p><strong>5. 全文检索(Full-text search)</strong></p>
<p>上面的<code>_like</code>是在<code>title</code>中查找的,使用 <code>q</code>，在对象全部value中遍历查找包含指定值的数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// 查找新闻全部字段包含 &quot;强拆&quot; 字样的数据</span><br><span class="line"></span><br><span class="line">GET /news?q=强拆</span><br></pre></td></tr></table></figure>
<p>###4.4 axios</p>
<p>上面介绍的<code>vue-resourc</code>e是<code>Vue.js</code>的一款插件,它可以通过<code>XMLHttpRequest</code>或<code>JSONP</code>发起请求并处理响应</p>
<p>但在实际应用中,<code>vue-resource</code>已经被摈弃了,而是使用<code>axios</code></p>
<p>简介，在vue升级到2.0后，官方就不再更新<code>vue-resourece</code>，vue官网也不再推荐<code>vue-resource</code>作为推荐的HTTP库.转而推荐使用：axios。</p>
<h4 id="1-使用axios"><a href="#1-使用axios" class="headerlink" title="1. 使用axios"></a>1. 使用axios</h4><p>1.首先肯定是安装并添加到生产环节的依赖</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm install axios --save</span><br></pre></td></tr></table></figure>
<p>2.在<code>main.js</code>中引入<code>axios</code></p>
<p>然后因为axios并不是vue的插件所以不能用<code>Vue.use</code>,但可以将它添加到Vue的原型中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import axios from &apos;axios&apos;</span><br><span class="line">//将axios添加到vue的原型中</span><br><span class="line">Vue.prototype.$http = axios</span><br></pre></td></tr></table></figure>
<p>这样我们也可以像调用vue-resourece一样在组件中调用axios的方法.</p>
<h4 id="2-利用axios跨域"><a href="#2-利用axios跨域" class="headerlink" title="2. 利用axios跨域"></a>2. 利用axios跨域</h4><p><code>axios</code>也提供了办法进行跨域</p>
<p><strong>设置代理:</strong>    </p>
<p>首先按上面的步骤下载配置axios,然后在<code>config/index.js</code>中的设置proxyTable的值为：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">proxyTable: &#123;</span><br><span class="line">      <span class="string">'/api'</span>: &#123;</span><br><span class="line">        target: <span class="string">'http://127.0.0.1:8081/'</span>,</span><br><span class="line">        changeOrigin: <span class="literal">true</span>,</span><br><span class="line">        pathRewrite: &#123;</span><br><span class="line">          <span class="string">'^/api'</span>: <span class="string">'/'</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>其中 ‘/api’ 为匹配项，target 为被请求的地址</p>
<p>因为在 ajax 的 url 中加了前缀 ‘/api’，而原本的接口是没有这个前缀的</p>
<p>所以需要<strong>通过 pathRewrite 来重写地址，将前缀 ‘/api’ 转为 ‘/‘</strong></p>
<p>如果本身的接口地址就有 ‘/api’ 这种通用前缀，就可以把 pathRewrite 删掉</p>
<p><strong>案例:</strong></p>
<p>获取豆瓣网的书本信息</p>
<p>如果我们直接用:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">getDouban () &#123;</span><br><span class="line">      <span class="keyword">this</span>.$http.get(<span class="string">'https://api.douban.com/v2/book/1220562'</span>)	<span class="comment">//直接请求这个地址</span></span><br><span class="line">        .then(<span class="function"><span class="keyword">function</span> (<span class="params">data</span>)</span>&#123;</span><br><span class="line">          <span class="built_in">console</span>.log(data)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>会报出请求失败:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">localhost/:<span class="number">1</span> Failed to load https:<span class="comment">//api.douban.com/v2/book/1220562: No 'Access-Control-Allow-Origin' header is present on the requested resource. Origin 'http://localhost:8080' is therefore not allowed access.</span></span><br></pre></td></tr></table></figure>
<p>所以这时候我们可以使用代理来进行获取数据</p>
<p>1.按上面的步骤安装配置好<code>axios</code></p>
<p>2.在<code>config/index.js</code>中的设置proxyTable的值为:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">proxyTable: &#123;</span><br><span class="line">      <span class="string">'/api'</span>: &#123;</span><br><span class="line">        target: <span class="string">'https://api.douban.com'</span>,	<span class="comment">//豆瓣网的接口</span></span><br><span class="line">        changeOrigin: <span class="literal">true</span>,</span><br><span class="line">        pathRewrite: &#123;</span><br><span class="line">          <span class="string">'^/api'</span>: <span class="string">'/'</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>
<p>3.在<code>App.vue</code>中设计一个按钮并添加方法:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id=<span class="string">"app"</span>&gt;</span><br><span class="line">	&lt;button @click=<span class="string">"getDouban"</span>&gt;获取豆瓣服务器的数据&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>div&gt;</span><br><span class="line">&lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp">&lt;script&gt;</span></span><br><span class="line"><span class="regexp">export default &#123;</span></span><br><span class="line"><span class="regexp">  name: 'app',</span></span><br><span class="line"><span class="regexp">  methods: &#123;</span></span><br><span class="line"><span class="regexp">    getDouban () &#123;</span></span><br><span class="line"><span class="regexp">      this.$http.get('https:/</span><span class="regexp">/api.douban.com/</span>v2/book/<span class="number">1220562</span><span class="string">')</span></span><br><span class="line"><span class="string">        .then(function (data)&#123;</span></span><br><span class="line"><span class="string">          console.log(data)</span></span><br><span class="line"><span class="string">        &#125;)</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;style&gt;</span></span><br><span class="line"><span class="string">&lt;/style&gt;</span></span><br></pre></td></tr></table></figure>
<p>点击按钮,可以获取到图书的信息打印在控制台中.</p>
<h2 id="第五章-json-server插件"><a href="#第五章-json-server插件" class="headerlink" title="第五章: json-server插件"></a>第五章: json-server插件</h2><p>在前后端分离的这种工作模式下，分工明确，各司其职。前端负责展示数据，后端提供数据。然而，在这种过程中对于接口的规范 需要提前制定好。例如根据规范提前模拟数据，这个时候就比较麻烦的。JsonServer这个比较NB了,它可以快速搭建服务端环境，创建json文件，便于调用。下面是使用过程：</p>
<h3 id="5-1-使用json-server"><a href="#5-1-使用json-server" class="headerlink" title="5.1 使用json-server"></a>5.1 使用json-server</h3><p>1.安装json-server </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install  json-server --save</span><br></pre></td></tr></table></figure>
<p>2.修改dev-server.js</p>
<p>添加到<code>server = app.listen(port)</code>之前</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">const jsonServer = require(&apos;json-server&apos;)</span><br><span class="line">const aipServer = jsonServer.create()</span><br><span class="line">const apiRouter = jsonServer.router(&apos;db.json&apos;) //此处的db.json是与package.json在同一目录下</span><br><span class="line">const middlewares = jsonServer.defaults()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">aipServer.use(middlewares)</span><br><span class="line">aipServer.use(apiRouter)</span><br><span class="line">aipServer.listen(port + 1, () =&gt; &#123;</span><br><span class="line">  console.log(&apos;JSON Server is running&apos;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>3.在根目录下创建并修改一个db.json文件 (如果你已经有了db.json,则省略这一步)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;getList&quot;:[</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;id&quot;:1,</span><br><span class="line">            &quot;title&quot;:&quot;title1&quot;,</span><br><span class="line">            &quot;content&quot;:&quot;content1&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;id&quot;:2,</span><br><span class="line">            &quot;title&quot;:&quot;title2&quot;,</span><br><span class="line">            &quot;content&quot;:&quot;content2&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;id&quot;:3,</span><br><span class="line">            &quot;title&quot;:&quot;title3&quot;,</span><br><span class="line">            &quot;content&quot;:&quot;content3&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>4.<strong>然后CD到项目文件夹下 cd..</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">json-server --watch data.json</span><br></pre></td></tr></table></figure>
<p>5.在浏览器打开网址验证json-server是否启动成功<br>在浏览器打开以下网址：<code>http://localhost:3000</code> (默认端口号:3000),你也可以使用如下命令修改它</p>
<p>成功打开地址后证明json-server安装成功，打开地址后可以看到db.json中的接口方法“getList”，点击“getList”，返回getList数据，证明可以成功调用mock数据。</p>
<ol>
<li>使用代理访问mock数据<br>我们在项目里访问什么路径会到json-server，这需要我们做一个代理。<br>4.1 修改 config文件夹中的index.js<br>修改index.js文件，在 dev 对象中的 proxyTable 设置以下代理对象</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">     &apos;/api&apos;: &#123;</span><br><span class="line">         target: &apos;http://localhost:8081&apos;,</span><br><span class="line">         changeOrigin: true,</span><br><span class="line">         pathRewrite: &#123;</span><br><span class="line">             &apos;^/api&apos;: &apos;/&apos;</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p><strong>注:数据的访问端口不能和你项目的启动端口号相同!!!</strong></p>
<p>否则就会报出一个:</p>
<p>端口号已经被使用的错误</p>
<p><strong>注: 项目文件的名字也不能为<code>json-server</code>,否则也会报错</strong></p>
<p>###5.2 修改端口号</p>
<p>默认端口号:3000,你也可以使用如下命令修改它</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ json-server --watch db.json --port 3004</span><br></pre></td></tr></table></figure>
<h3 id="5-3-设置常用路由地址"><a href="#5-3-设置常用路由地址" class="headerlink" title="5.3 设置常用路由地址"></a>5.3 设置常用路由地址</h3><p>当我们在进行<code>http</code>请求<code>json-server</code>数据的时候,有一些常用的路由地址,我们可以用一个<code>json</code>文件来盛放它</p>
<p>1.在根目录下,创建一个<code>routes.json</code>的文件,并写上你常用的路由地址:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"/api/*"</span>: <span class="string">"/$1"</span>,</span><br><span class="line">  <span class="attr">"/:resource/:id/show"</span>: <span class="string">"/:resource/:id"</span>,</span><br><span class="line">  <span class="attr">"/posts/:category"</span>: <span class="string">"/posts?category=:category"</span>,</span><br><span class="line">  <span class="attr">"/articles\\?id=:id"</span>: <span class="string">"/posts/:id"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2.将<code>json-server</code>和你的<code>routes.json</code>关联起来:</p>
<p>使用以下命令:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">json-server db.json --routes routes.json</span><br></pre></td></tr></table></figure>
<p>3.现在你可以使用以下命令来直接访问资源了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/api/posts # → /posts</span><br><span class="line">/api/posts/1  # → /posts/1</span><br><span class="line">/posts/1/show # → /posts/1</span><br><span class="line">/posts/javascript # → /posts?category=javascript</span><br><span class="line">/articles?id=1 # → /posts/1</span><br></pre></td></tr></table></figure>
<h3 id="5-4-json-server的关系图谱"><a href="#5-4-json-server的关系图谱" class="headerlink" title="5.4 json-server的关系图谱"></a>5.4 json-server的关系图谱</h3><p><code>json-server</code>是非常好用的一款模拟REST API的工具,文档也很详细和全面. 详情：<a href="https://github.com/typicode/json-server" target="_blank" rel="noopener">json-server</a> 而其中的关系图谱是它非常强大的一个功能，可以非常方便实现多个路由之间关联数据的获取。</p>
<p><strong>案例:</strong>    </p>
<p>官网上对于关系图谱的案例非常好，我这里在它示例的基础上稍以改进，进行说明，首先我这里编写了一个原始数据,<code>db.json</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;posts&quot;: [</span><br><span class="line">    &#123; &quot;id&quot;: 1, &quot;title&quot;: &quot;post的第一个title&quot;, &quot;author&quot;: &quot;typicode&quot; &#125;,</span><br><span class="line">    &#123; &quot;id&quot;: 2, &quot;title&quot;: &quot;post的第二个title&quot;, &quot;author&quot;: &quot;tangcaiye&quot; &#125;</span><br><span class="line">  ],</span><br><span class="line">  &quot;comments&quot;: [</span><br><span class="line">    &#123; &quot;id&quot;: 1, &quot;body&quot;: &quot;some comment1111&quot;, &quot;postId&quot;: 2 &#125;,</span><br><span class="line">    &#123; &quot;id&quot;: 2, &quot;body&quot;: &quot;some comment2222&quot;, &quot;postId&quot;: 1 &#125;</span><br><span class="line">  ],</span><br><span class="line">  &quot;profile&quot;: &#123; &quot;name&quot;: &quot;typicode&quot; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里对这个<code>db.json</code>数据内容解释一下： 这个json文件中<code>posts</code>跟<code>comments</code>是有关联的，他们的关系通过的就是<code>comments</code>下<code>postId</code>属性，<code>postId</code>对应的就是<code>posts</code>的<code>id</code>。 比如<code>comments</code>下<code>postId:2</code>的对象关联的就是posts下的<code>{ &quot;id&quot;: 2, &quot;title&quot;: &quot;post的第二个title&quot;, &quot;author&quot;: &quot;tangcaiye&quot; }</code></p>
<p>####1. _embed    </p>
<p><code>json-server</code>中的<code>_embed</code>就是用来获取包含下级资源的数据. 比如我<code>json-server</code>服务器的端口号是<code>8081</code>,然后我的请求路径是<code>http://localhost:8081/posts/2?_embed=comments</code> 这个路径获取的就是posts下的id为2的数据和它关联的comments的数据：<code>{ &quot;id&quot;: 1, &quot;body&quot;: &quot;some comment1111&quot;, &quot;postId&quot;: 2 }</code>输出结果为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;id&quot;: 2,</span><br><span class="line">  &quot;title&quot;: &quot;post的第二个title&quot;,</span><br><span class="line">  &quot;author&quot;: &quot;tangcaiye&quot;,</span><br><span class="line">  &quot;comments&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;id&quot;: 1,</span><br><span class="line">      &quot;body&quot;: &quot;some comment1111&quot;,</span><br><span class="line">      &quot;postId&quot;: 2</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>####2. _expand</p>
<p>如果理解了<code>_embed</code>那么<code>_expand</code>它也就很轻松了,<code>_expand</code>获取的是包含上级资源的数据： 路径：<code>http://localhost:8081/comments/2?_expand=post</code> 上面这个路径获取的就是<code>comments</code>下<code>id</code>为2的数据和它关联的上级资源<code>post</code>，也就是<code>posts</code>下的： <code>{ &quot;id&quot;: 1, &quot;title&quot;: &quot;post的第一个title&quot;, &quot;author&quot;: &quot;typicode&quot; }</code> 输出结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;id&quot;: 2,</span><br><span class="line">  &quot;body&quot;: &quot;some comment2222&quot;,</span><br><span class="line">  &quot;postId&quot;: 1,</span><br><span class="line">  &quot;post&quot;: &#123;</span><br><span class="line">    &quot;id&quot;: 1,</span><br><span class="line">    &quot;title&quot;: &quot;post的第一个title&quot;,</span><br><span class="line">    &quot;author&quot;: &quot;typicode&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="3-只获取下级资源"><a href="#3-只获取下级资源" class="headerlink" title="3. 只获取下级资源"></a>3. 只获取下级资源</h4><p>有时候我们可能想只获取下级资源，可以通过： 路径：<code>http://localhost:8081/posts/2/comments</code> 上面这个路径就是获取<code>posts</code>的<code>id:2</code>所关联的<code>comments</code>数据： 返回结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    &quot;id&quot;: 1,</span><br><span class="line">    &quot;body&quot;: &quot;some comment1111&quot;,</span><br><span class="line">    &quot;postId&quot;: 2</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>但因为<code>jsonserver</code>服务器的端口号跟我们的服务器端口不一样，也就是跨域了，所以可以在vue-cli中设置代理:</p>
<p>####4.总结</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1.获取下级资源(从post =&gt; postId)</span><br><span class="line">http://localhost:8081/posts/2?_embed=comments</span><br><span class="line">2.获取上级资源(从postId =&gt; post)</span><br><span class="line">http://localhost:8081/comments/2?_expand=post</span><br><span class="line">3.只获取下级资源</span><br><span class="line">http://localhost:8081/posts/2/comments</span><br></pre></td></tr></table></figure>
<h2 id="第六章-mockjs"><a href="#第六章-mockjs" class="headerlink" title="第六章: mockjs"></a>第六章: mockjs</h2><h3 id="6-1-基本使用"><a href="#6-1-基本使用" class="headerlink" title="6.1 基本使用"></a>6.1 基本使用</h3><p>1.安装mockjs</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i mockjs --save</span><br></pre></td></tr></table></figure>
<p>2.使用mockjs</p>
<p>在根目录下创建mock.js并编写</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Mock = <span class="built_in">require</span>(<span class="string">'mockjs'</span>)</span><br><span class="line"><span class="keyword">var</span> data = Mock.mock(&#123;</span><br><span class="line">    <span class="comment">// 属性 list 的值是一个数组，其中含有 1 到 10 个元素</span></span><br><span class="line">    <span class="string">'list|1-10'</span>: [&#123;</span><br><span class="line">        <span class="comment">// 属性 id 是一个自增数，起始值为 1，每次增 1</span></span><br><span class="line">        <span class="string">'id|+1'</span>: <span class="number">1</span></span><br><span class="line">    &#125;]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 输出结果</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(data, <span class="literal">null</span>, <span class="number">4</span>))</span><br></pre></td></tr></table></figure>
<p>3.由于Mock.js是插件,为了让人能看懂,最好在package.js中的scripts写入:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;mock&quot;: &quot;node mock.js&quot;</span><br></pre></td></tr></table></figure>
<h3 id="6-2-mockjs配合fs写入数据"><a href="#6-2-mockjs配合fs写入数据" class="headerlink" title="6.2 mockjs配合fs写入数据"></a>6.2 mockjs配合fs写入数据</h3><p>在根目录下创建mock.js并编写:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用 Mock</span></span><br><span class="line"><span class="keyword">var</span> Mock = <span class="built_in">require</span>(<span class="string">'mockjs'</span>)</span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"><span class="keyword">var</span> data = Mock.mock(&#123;</span><br><span class="line">  <span class="comment">//list|1-10 数组元素个数随机范围， id|+2 属性值递增, age|20-30数值随机范围</span></span><br><span class="line">  <span class="comment">// test|3.2-5 3.xx-3.xxxxx 整数位3，小数位位数范围为2-5</span></span><br><span class="line">  <span class="comment">//'yourname|2-4': 'alice-' 重复字符串的次数范围2-4</span></span><br><span class="line">  <span class="comment">//常规真实数据格式，@name @color @url @first @last @image</span></span><br><span class="line">  <span class="string">'list|1-10'</span>: [&#123;<span class="string">'id|+2'</span>: <span class="number">1</span> , <span class="string">'age|20-30'</span>: <span class="number">100</span>&#125;],</span><br><span class="line">  <span class="string">'name'</span>: <span class="string">'@name'</span>,</span><br><span class="line">  <span class="string">'color'</span>: <span class="string">'@color'</span>,</span><br><span class="line">  <span class="string">'url'</span>: <span class="string">'@url'</span>,</span><br><span class="line">  <span class="string">'email'</span>: <span class="string">'@email'</span>,</span><br><span class="line">  <span class="string">'friends|3'</span>: [&#123;<span class="attr">name</span>: <span class="string">'@name'</span>&#125;],</span><br><span class="line">  <span class="string">'price|10-20.1-4'</span>: <span class="number">11</span>,</span><br><span class="line">  <span class="string">'cost|10-20.3'</span>: <span class="number">11</span>,</span><br><span class="line">  <span class="string">'test|3.2-5'</span>: <span class="number">52</span>,</span><br><span class="line">  <span class="string">'yourname|2-4'</span>: <span class="string">'alice-'</span>,</span><br><span class="line">  <span class="string">'img'</span>: <span class="string">'@image(200x100,@color,tangcaiye)'</span>,</span><br><span class="line">  <span class="string">'txt'</span>: <span class="string">'@cword(3)'</span>,</span><br><span class="line">  <span class="string">'cname'</span>: <span class="string">'@cname'</span></span><br><span class="line">  &#125;);</span><br><span class="line"><span class="comment">// console.log(JSON.stringify(data, null, 2));</span></span><br><span class="line"><span class="comment">// 写入到db.json</span></span><br><span class="line">fs.writeFile(<span class="string">'db.json'</span>, <span class="built_in">JSON</span>.stringify(data, <span class="literal">null</span>, <span class="number">2</span>),  <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">console</span>.error(err);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"数据写入成功！"</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><code>db.json</code>不需要我们创建,后台会自动生成一个db.json文件</p>
<p>执行:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node mockjs</span><br></pre></td></tr></table></figure>
<p>可以看到控制台输出”数据写入成功!”,此时我们的文件夹下多了一个<code>db.json</code>文件,并且其中的数据已经写好</p>
<h2 id="第七章-json-mockjs-http案例"><a href="#第七章-json-mockjs-http案例" class="headerlink" title="第七章: json+mockjs+http案例"></a>第七章: json+mockjs+http案例</h2><p>1.创建一个<code>webpack</code>,名为<code>demo</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ vue init webpack demo</span><br><span class="line">vue-router   Y</span><br></pre></td></tr></table></figure>
<p>2.依次使用指令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install vue-resource --save</span><br><span class="line">npm install  json-server --save</span><br><span class="line">npm i mockjs --save</span><br></pre></td></tr></table></figure>
<p>3.在<code>main.js</code>引入<code>vue-resource</code>    </p>
<p><code>`</code></p>

    
    </div>
    
    
        <div class="article-comment" id="article-comment">
            

<h1>评论</h1>

  
    <div id="valine"></div>
  


        </div>
        
</article>
  </div>

  

<footer id="footer">
    <div class="footer-copyright">
        <div>
            <p> 版权所有 <a href="">LinDaiDai </a> @ 2019</p>
            <!--<p>设计: <i class="fas fa-paint-brush"></i> <a href="https://moober.cn">Moober</a> 和 <i class="fas fa-graduation-cap"></i> <a href="https://qutang.github.io">Qu Tang</a> &bull; 主题: <a href="https://qutang.github.io/cutie/">Cutie 2.1.3-Taurus</a> &bull; 由 <a href="http://hexo.io">Hexo.</a> 强力驱动</p>-->
        </div>
    </div>
    
    <div class="footer-social">
        
            
                
                    <div class="footer-social-item"><a href="https://github.com/LinDaiDai" target="_blank"><i class="fab fa-github fa-2x" aria-hidden="true"></i></a></div>
                
            
                
                    <div class="footer-social-item"><a href="https://github.com/LinDaiDai" target="_blank"><i class="fab fa-weixin fa-2x" aria-hidden="true"></i></a></div>
                
            
                
                    <div class="footer-social-item"><a href="https://github.com/LinDaiDai" target="_blank"><i class="fab fa-qq fa-2x" aria-hidden="true"></i></a></div>
                
            
        
    </div>
</footer>

  <br>

  <div id="footer-nav" class='footer-nav'>
		



<nav id="nav">
	
	
		
			
				
			
		
		
	
		
			
		
		
	
	
	<div class="nav-item" id="nav-item-toc">
		


<div class="toc-container">
<i class="far fa-times-circle" id="toc-close" onclick="closeTOC(event);" ontouchstart="closeTOC(event);"></i>
<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#第一章-项目运行"><span class="toc-number">1.</span> <span class="toc-text">第一章: 项目运行</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第二章-router"><span class="toc-number">2.</span> <span class="toc-text">第二章: router</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-基本使用"><span class="toc-number">2.1.</span> <span class="toc-text">2.1 基本使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-案例1"><span class="toc-number">2.2.</span> <span class="toc-text">2.2 案例1:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-通过js控制跳转"><span class="toc-number">2.3.</span> <span class="toc-text">2.3 通过js控制跳转</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-路由器嵌套"><span class="toc-number">2.4.</span> <span class="toc-text">2.4 路由器嵌套</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-案例"><span class="toc-number">2.4.1.</span> <span class="toc-text">1. 案例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-重定向"><span class="toc-number">2.5.</span> <span class="toc-text">2.5 重定向</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-6-路由配合动画"><span class="toc-number">2.6.</span> <span class="toc-text">2.6 路由配合动画</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第三章-vuex"><span class="toc-number">3.</span> <span class="toc-text">第三章: vuex</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-安装vuex"><span class="toc-number">3.1.</span> <span class="toc-text">3.1 安装vuex</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-vuex基础"><span class="toc-number">3.2.</span> <span class="toc-text">3.2 vuex基础</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-state"><span class="toc-number">3.2.1.</span> <span class="toc-text">1. state</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-getters"><span class="toc-number">3.2.2.</span> <span class="toc-text">2. getters</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-mutation"><span class="toc-number">3.2.3.</span> <span class="toc-text">3. mutation</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-action"><span class="toc-number">3.2.4.</span> <span class="toc-text">4. action</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-module"><span class="toc-number">3.2.5.</span> <span class="toc-text">5. module</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-vuex项目结构"><span class="toc-number">3.3.</span> <span class="toc-text">3.3 vuex项目结构</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第四章-http相关"><span class="toc-number">4.</span> <span class="toc-text">第四章: http相关</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-promise"><span class="toc-number">4.1.</span> <span class="toc-text">4.1 promise</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-传统的异步操作转promise"><span class="toc-number">4.1.1.</span> <span class="toc-text">2. 传统的异步操作转promise</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-ES7的Async-Await"><span class="toc-number">4.2.</span> <span class="toc-text">4.2  ES7的Async/Await</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-基本规则"><span class="toc-number">4.2.1.</span> <span class="toc-text">1. 基本规则</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-获得返回值"><span class="toc-number">4.2.2.</span> <span class="toc-text">2. 获得返回值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-捕捉错误"><span class="toc-number">4.2.3.</span> <span class="toc-text">3. 捕捉错误</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-循环多个await"><span class="toc-number">4.2.4.</span> <span class="toc-text">4. 循环多个await</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-vue-resource"><span class="toc-number">4.3.</span> <span class="toc-text">4.3 vue-resource</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-安装使用vue-resource"><span class="toc-number">4.3.1.</span> <span class="toc-text">1. 安装使用vue-resource</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-http的方法"><span class="toc-number">4.3.2.</span> <span class="toc-text">3. http的方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-get"><span class="toc-number">4.3.3.</span> <span class="toc-text">4. get</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-使用axios"><span class="toc-number">4.3.4.</span> <span class="toc-text">1. 使用axios</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-利用axios跨域"><span class="toc-number">4.3.5.</span> <span class="toc-text">2. 利用axios跨域</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第五章-json-server插件"><span class="toc-number">5.</span> <span class="toc-text">第五章: json-server插件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-使用json-server"><span class="toc-number">5.1.</span> <span class="toc-text">5.1 使用json-server</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-设置常用路由地址"><span class="toc-number">5.2.</span> <span class="toc-text">5.3 设置常用路由地址</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-json-server的关系图谱"><span class="toc-number">5.3.</span> <span class="toc-text">5.4 json-server的关系图谱</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-只获取下级资源"><span class="toc-number">5.3.1.</span> <span class="toc-text">3. 只获取下级资源</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第六章-mockjs"><span class="toc-number">6.</span> <span class="toc-text">第六章: mockjs</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-基本使用"><span class="toc-number">6.1.</span> <span class="toc-text">6.1 基本使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-mockjs配合fs写入数据"><span class="toc-number">6.2.</span> <span class="toc-text">6.2 mockjs配合fs写入数据</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第七章-json-mockjs-http案例"><span class="toc-number">7.</span> <span class="toc-text">第七章: json+mockjs+http案例</span></a></li></ol>
</div>
<div class="toc-button" onclick="toggleTOC(event);" ontouchstart="toggleTOC(event);">
    <img src="/images/icons/blue-shadow/toc.svg" alt="">
</div>

	</div>
	
	<div class="nav-item" id="nav-item-archive">
		
				<div class="nav-icon">
				
			<a href="/archives/" title="归档">
			<img src="/images/icons/blue-shadow/archive.svg" alt="">
			</a>
		</div>
	</div>
	<div class="nav-item" id="nav-item-search">
		
		<div class="nav-icon">
		
			<a href="/search/" title="搜索">
			<img src="/images/icons/blue-shadow/search.svg" alt="">
			</a>
		</div>
	</div>
	<div class="nav-item" id="nav-item-more">
		<div class="nav-icon">
				<a href="#" onclick="onClickMenuIcon(event);" ontouchstart="onClickMenuIcon(event);">
				<img src="/images/icons/blue-shadow/menu.svg" alt="">
				</a>
		</div>
		<div class="nav-more-menu">
				<i class="far fa-times-circle" id="nav-more-menu-close" onclick="onClickNavMenuClose(event);" ontouchstart="onClickNavMenuClose(event);"></i>
		
			
			
				
			
				
			
				
			
				
			
				
			
				
			
		
			<div class="nav-more-item">
					<div class="nav-name">
						<a class="nav-link" href="/home/">
							<span>首页</span>
						</a>
					</div>
			</div>
		
		
			
			
				
			
				
			
				
			
				
			
				
			
				
			
		
			<div class="nav-more-item">
					<div class="nav-name">
						<a class="nav-link" href="/about/">
							<span>关于</span>
						</a>
					</div>
			</div>
		
		
		
		<div class="nav-more-item">
				<div class="nav-name">
					<a class="nav-link" href="/categories/mySql/">
						<span>Mysql</span>
					</a>
				</div>
		</div>
		
		<div class="nav-more-item">
				<div class="nav-name">
					<a class="nav-link" href="/categories/php/">
						<span>Php</span>
					</a>
				</div>
		</div>
		
		<div class="nav-more-item">
				<div class="nav-name">
					<a class="nav-link" href="/categories/其它技能/">
						<span>其它技能</span>
					</a>
				</div>
		</div>
		
		<div class="nav-more-item">
				<div class="nav-name">
					<a class="nav-link" href="/categories/vscode/">
						<span>Vscode</span>
					</a>
				</div>
		</div>
		
		<div class="nav-more-item">
				<div class="nav-name">
					<a class="nav-link" href="/categories/前端进阶/">
						<span>前端进阶</span>
					</a>
				</div>
		</div>
		
		<div class="nav-more-item">
				<div class="nav-name">
					<a class="nav-link" href="/categories/前端入门/">
						<span>前端入门</span>
					</a>
				</div>
		</div>
		
	</div>
	</div>
</nav>

	</div>

  



    

    
    
    
<script>
    new Valine({
        el: '#valine',
        notify:false, 
        verify:false,
        appId: '0Nyr31J74bB24hrKnRrheEdf-gzGzoHsz',
        appKey: 'RYPhOnr007gXeWPQr3V1VFHH',
        placeholder: '说点什么吧...',
        path:window.location.pathname, 
        avatar:'monsterid',
        lang: 'zh-cn',
        visitor: true // 阅读量统计
    });
</script>









    <script src="/js/lightgallery.min.js"></script>
<script src="/js/lg-zoom.min.js"></script>
<script type="text/javascript">
    $(document).ready(function() {
        $("#lightgallery").lightGallery(); 
        $(".article-content img").each(function(){
            console.log($(this).attr('src'))
            $(this).attr('data-src', $(this).attr('src')).lightGallery({
                selector: 'this'
            })
        });
    });
</script>






<script type="text/javascript">

  
  // update cookie if this page is opened (directly)
  loadjs(['/libs/jshashes/hashes.min.js', '/libs/js-cookie/src/js.cookie.js', '/js/post.v2.js'], 'post-version');
  loadjs.ready('post-version', function(){
    
    new Postv2('hashit_6ca41daa0fc8147339ef0a581490fe134a0243dc12aa787160f837457566d641').update('hashit_82c4017765ecba78b6a4e7027324474efe45515cc524f9d28b3e876d92ac5aeb', function(){});
  });
  
</script>


    
<script type="text/javascript">
  
  // update cookie if this page is opened (directly)
  function getIP(json) {
  loadjs(['/libs/jshashes/hashes.min.js', '/libs/js-cookie/src/js.cookie.js', '/js/leancloud.js'], 'post-visit-comment-count');
  loadjs.ready('post-visit-comment-count', function(){
    
    
    LeanCloud.init('', '');
    var leanCloud = LeanCloud.getInstance();
    leanCloud.fetchIsThumbUp('/2017/03/09/webNotes/primary/Vue/vue-cli/', json.ip);
    document.getElementById('thumb-up-button').addEventListener('click', function(e){
      leanCloud.isThumbUp('/2017/03/09/webNotes/primary/Vue/vue-cli/', function(isThumbUp){
        console.log('is thumb up:' + isThumbUp);
        if(isThumbUp){
          leanCloud.removeThumbUpRecord('/2017/03/09/webNotes/primary/Vue/vue-cli/', json.ip);
          document.getElementById('thumb-up-icon').className = "far fa-thumbs-up fa-lg";
          
        }else{
          leanCloud.addThumbUpRecord('/2017/03/09/webNotes/primary/Vue/vue-cli/', json.ip);
          document.getElementById('thumb-up-icon').className = "fas fa-thumbs-up fa-lg";
        }
        leanCloud.getThumbUpCount('/2017/03/09/webNotes/primary/Vue/vue-cli/', function(count){
            console.log('thumb up count: ' + count)
            var el = document.getElementById('article-thumbup-count');
            if(el) el.innerHTML = count;
        });
      });
    });
    leanCloud.addVisitRecord('/2017/03/09/webNotes/primary/Vue/vue-cli/', json.ip);
    leanCloud.fetchCommentCount('/2017/03/09/webNotes/primary/Vue/vue-cli/');
    leanCloud.fetchVisitCount('/2017/03/09/webNotes/primary/Vue/vue-cli/');
    leanCloud.fetchThumbUpCount('/2017/03/09/webNotes/primary/Vue/vue-cli/');
    leanCloud.getCommentCount('/2017/03/09/webNotes/primary/Vue/vue-cli/', function(count){
        var el = document.querySelector('#article-comment-count');
        if(el) el.innerHTML = count;
    });
    leanCloud.getVisitCount('/2017/03/09/webNotes/primary/Vue/vue-cli/', function(count){
        var el = document.querySelector('#article-visit-count');
        if(el) el.innerHTML = count;
    });
    leanCloud.getThumbUpCount('/2017/03/09/webNotes/primary/Vue/vue-cli/', function(count){
        var el = document.getElementById('article-thumbup-count');
        if(el) el.innerHTML = count;
    });
    leanCloud.isThumbUp('/2017/03/09/webNotes/primary/Vue/vue-cli/', function(isThumbUp){
        console.log('init thumb up:' + isThumbUp);
        if(isThumbUp){
          document.getElementById('thumb-up-icon').className = "fas fa-thumbs-up fa-lg";
        }else{
          document.getElementById('thumb-up-icon').className = "far fa-thumbs-up fa-lg";
        }
    });
  });
  }
  
</script>

<script type="application/javascript" src="https://api.ipify.org?format=jsonp&callback=getIP"></script>



<!-- <script src="/js/post.js"></script> -->

<script src="/js/headroom.min.js"></script>

<script data-no-instant="" type="text/javascript">

initHeadroom();

changeLayoutOnTouchScreen();

// 
// var post = new Post('', '');
// post.getCommentCount(window.location.pathname, function(count){
//     $('#article-comment-count').text(count);
// });
// post.addVisitRecord(window.location.pathname, userip);
// post.getVisitCount(window.location.pathname, function(count){
//     $('#article-visit-count').text(count);
// });

// 
</script>


<!-- End Document
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
</body>
</html>
